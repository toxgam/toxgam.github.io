(this["webpackJsonphappy-author"]=this["webpackJsonphappy-author"]||[]).push([[168],{2365:function(e,t,n){"use strict";n.d(t,"a",(function(){return P}));var r=n(9),a=n.n(r),i=n(10),o=n.n(i),c=n(5),u=n.n(c),s=n(15),l=n.n(s),f=n(18),d=n.n(f),p=n(7),v=n.n(p),h=n(1),m=n.n(h),y=n(0),w=n.n(y),b=n(805),g=n(2088),k=n(2363),x=n.n(k),E=n(855),C=n(2362),S=n(2356),R=n(2385);function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return d()(this,n)}}var P=function(e){l()(n,e);var t=A(n);function n(){var e;a()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i)),m()(u()(e),"state",e.getInitialState()),m()(u()(e),"onMediaDisplayed",(function(){var t=e.props.item;E.a.emit("media-viewed",{fileId:t.id,viewingLevel:"full"})})),e}return o()(n,[{key:"componentDidMount",value:function(){this.init()}},{key:"componentWillUnmount",value:function(){this.release()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.needsReset(e,this.props)&&(this.release(),this.setState(this.initialState))}},{key:"componentDidUpdate",value:function(e){this.needsReset(e,this.props)&&this.init()}},{key:"render",value:function(){var e=this;return this.state.content.match({pending:function(){return w.a.createElement(S.a,null)},successful:function(t){return e.renderSuccessful(t)},failed:function(t){var n=e.props.item;return w.a.createElement(C.a,{fileId:n.id,fileState:n,error:t,supressAnalytics:!0},w.a.createElement("p",null,w.a.createElement(b.a,g.a.try_downloading_file)),e.renderDownloadButton(t))}})}},{key:"getInitialState",value:function(){return this.initialState}},{key:"renderDownloadButton",value:function(e){var t=this.props,n=t.item,r=t.mediaClient,a=t.collectionName;return w.a.createElement(R.b,{fileState:n,mediaClient:r,error:e,collectionName:a})}},{key:"needsReset",value:function(e,t){return!x()(e.item,t.item)||e.mediaClient!==t.mediaClient||e.collectionName!==t.collectionName}}]),n}(w.a.Component)},2399:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=(r=n(0))&&r.__esModule?r:{default:r},i=n(53);var o=function(e){return a.default.createElement(i.Icon,Object.assign({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><path d="M8.595 19.522C7.162 20.364 6 19.702 6 18.04V5.963C6 4.3 7.158 3.635 8.595 4.479l11.083 6.51c.951.559.958 1.46 0 2.023l-11.083 6.51z" fill="currentColor" fill-rule="evenodd"/></svg>'},e))};o.displayName="VidPlayIcon";var c=o;t.default=c},2430:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(25),a=n.n(r),i=n(12),o=n.n(i),c=n(241),u=function(){var e=a()(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(c.a)(t)){e.next=14;break}if(!(n=t.preview)){e.next=14;break}return e.prev=3,e.t0=URL,e.next=7,n;case 7:return e.t1=e.sent.value,e.abrupt("return",e.t0.createObjectURL.call(e.t0,e.t1));case 11:return e.prev=11,e.t2=e.catch(3),e.abrupt("return",void 0);case 14:return e.abrupt("return",void 0);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}()},2524:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator;return-1!==e.userAgent.indexOf("MSIE")||e.appVersion.indexOf("Trident/")>0}},2525:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r,a=(r=n(0))&&r.__esModule?r:{default:r},i=n(53);var o=function(e){return a.default.createElement(i.Icon,Object.assign({dangerouslySetGlyph:'<svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><rect fill="currentColor" x="4" y="4" width="16" height="16" rx="2"/><path d="M16 9.283V13.6h-.003A1.5 1.5 0 1114.5 12c.175 0 .344.03.5.085v-2.08l-4 .431V14.6h-.003A1.5 1.5 0 018 14.5a1.5 1.5 0 012-1.415V9.034c0-.238.186-.451.432-.478l5.136-.553a.38.38 0 01.432.384v.896z" fill="inherit"/></svg>'},e))};o.displayName="MediaServicesAudioIcon";var c=o;t.default=c},3207:function(e,t,n){"use strict";n.r(t),n.d(t,"AudioViewer",(function(){return L}));var r=n(25),a=n.n(r),i=n(9),o=n.n(i),c=n(10),u=n.n(c),s=n(5),l=n.n(s),f=n(15),d=n.n(f),p=n(18),v=n.n(p),h=n(7),m=n.n(h),y=n(1),w=n.n(y),b=n(12),g=n.n(b),k=n(0),x=n.n(k),E=n(855),C=n(2525),S=n.n(C),R=n(3179),A=n(2349),P=n(2355),I=n(2365),O=n(2524),U=n(3290),j=n(2430),_=n(2505);function M(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m()(e);if(t){var a=m()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return v()(this,n)}}var N=x.a.createElement(P.l,null,x.a.createElement(S.a,{label:"cover",size:"xlarge",primaryColor:_.g})),B=function(e,t,n){return t.getImageUrl(e.id,{collection:n})},L=function(e){d()(n,e);var t=M(n);function n(){var e;o()(this,n);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),w()(l()(e),"renderCover",(function(){var t=e.props.item,n=e.state.coverUrl;return n&&"error"!==t.status?x.a.createElement(P.d,{src:n,alt:t.name}):N})),w()(l()(e),"saveAudioElement",(function(e){e&&e.setAttribute("controlsList","nodownload")})),w()(l()(e),"onFirstPlay",(function(){var t=e.props.item;E.a.emit("media-viewed",{fileId:t.id,viewingLevel:"full"})})),w()(l()(e),"onError",(function(){var t=e.props.onError;t&&t(new A.b("audioviewer-playback"))})),w()(l()(e),"loadCover",(function(e){return new Promise(function(){var t=a()(g.a.mark((function t(n,r){var a;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=new Image).src=e,a.onload=n,a.onerror=r;case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())})),w()(l()(e),"setCoverUrl",a()(g.a.mark((function t(){var n,r,a,i,o;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props,r=n.mediaClient,a=n.item,i=n.collectionName,"processed"===a.status){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,B(a,r,i);case 5:return o=t.sent,t.prev=6,t.next=9,e.loadCover(o);case 9:e.setState({coverUrl:o}),t.next=14;break;case 12:t.prev=12,t.t0=t.catch(6);case 14:case"end":return t.stop()}}),t,null,[[6,12]])})))),e}return u()(n,[{key:"initialState",get:function(){return{content:R.a.pending()}}},{key:"renderSuccessful",value:function(e){var t=this.props,n=t.item,r=t.showControls,a=t.previewCount,i=t.onCanPlay,o=0===a;return!Object(O.a)()?x.a.createElement(P.e,{"data-testid":"media-viewer-audio-content"},this.renderCover(),x.a.createElement(P.j,null,x.a.createElement(U.a,{type:"audio",isAutoPlay:o,src:e,fileId:n.id,isShortcutEnabled:!0,showControls:r,onCanPlay:i,onFirstPlay:this.onFirstPlay,onError:this.onError}))):x.a.createElement(P.e,null,this.renderCover(),x.a.createElement(P.j,null,x.a.createElement(P.c,{autoPlay:o,controls:!0,ref:this.saveAudioElement,src:e,preload:"metadata"})))}},{key:"init",value:function(){var e=a()(g.a.mark((function e(){var t,n,r,a,i;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.mediaClient,r=t.item,a=t.collectionName,e.prev=1,"processed"!==r.status){e.next=10;break}return e.next=5,n.file.getArtifactURL(r.artifacts,"audio.mp3",a);case 5:if(i=e.sent){e.next=8;break}throw new A.b("audioviewer-missing-artefact");case 8:e.next=16;break;case 10:return e.next=12,Object(j.a)(r);case 12:if(i=e.sent){e.next=16;break}return this.setState({content:R.a.pending()}),e.abrupt("return");case 16:this.setCoverUrl(),this.setState({content:R.a.successful(i)}),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),this.setState({content:R.a.failed(new A.b("audioviewer-fetch-url",e.t0))});case 23:case"end":return e.stop()}}),e,this,[[1,20]])})));return function(){return e.apply(this,arguments)}}()},{key:"release",value:function(){var e=this.state.content;e.data&&URL.revokeObjectURL(e.data)}}]),n}(I.a)}}]);