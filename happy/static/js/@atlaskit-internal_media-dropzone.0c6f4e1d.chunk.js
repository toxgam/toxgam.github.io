/*! For license information please see @atlaskit-internal_media-dropzone.0c6f4e1d.chunk.js.LICENSE.txt */
(this["webpackJsonphappy-author"]=this["webpackJsonphappy-author"]||[]).push([[78],{2368:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r={1:"none",2:"rotateY(180deg)",3:"rotate(180deg)",4:"rotate(180deg) rotateY(180deg)",5:"rotate(270deg) rotateY(180deg)",6:"rotate(90deg)",7:"rotate(90deg) rotateY(180deg)",8:"rotate(270deg)"},a=function(e){return e>=5},i=function(e){return r[e]}},2386:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return l}));var r=n(2467),a=n(3117),i=n(2402),o={newCardExperience:!0,captions:!1,timestampOnVideo:!1,observedWidth:!1,mediaInline:!1,folderUploads:!0,mediaUploadApiV2:!0},c=Object(a.b)(o),u=Object(a.a)(o);function s(e){return{packageName:i.a,packageVersion:i.b,componentName:e,component:e}}function l(e){if(e&&Object(r.b)(e))return e.metadata}},2402:function(e){e.exports=JSON.parse('{"a":"@atlaskit/media-picker","b":"63.0.1"}')},2403:function(e,t,n){(function(e){!function(t){"use strict";var n="[object process]"===Object.prototype.toString.call("undefined"!==typeof e?e:0),r="undefined"!==typeof performance&&"undefined"!==typeof performance.now&&"function"===typeof performance.mark&&"function"===typeof performance.measure&&("function"===typeof performance.clearMarks||"function"===typeof performance.clearMeasures),a="undefined"!==typeof PerformanceObserver&&"undefined"!==typeof PerformanceObserver.prototype&&"function"===typeof PerformanceObserver.prototype.constructor,i={},o={},c=function(){return r?performance.now():Date.now()},u=function(e){i[e]=void 0,o[e]&&(o[e]=void 0),r&&(n||performance.clearMeasures(e),performance.clearMarks(e))},s=function(e){if(r){if(n&&a){var t=new PerformanceObserver((function(n){o[e]=n.getEntries().find((function(t){return t.name===e})),t.disconnect()}));t.observe({entryTypes:["measure"]})}performance.mark(e)}i[e]=c()},l=function(e,t){try{var a=i[e];return r?(t||performance.mark(e+"-end"),performance.measure(e,e,t||e+"-end"),n?o[e]?o[e]:a?{duration:c()-a,startTime:a,entryType:"measure",name:e}:{}:performance.getEntriesByName(e).pop()||{}):a?{duration:c()-a,startTime:a,entryType:"measure",name:e}:{}}catch(s){return{}}finally{u(e),u(t||e+"-end")}},f=function(){i={},o={},r&&(n||performance.clearMeasures(),performance.clearMarks())},p=function(e){return!r||n?[]:performance.getEntriesByType(e)||[]},d=function(){return p("navigation").pop()||{}};function v(e,t,n,r){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function c(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){e.done?n(e.value):a(e.value).then(o,c)}u((r=r.apply(e,t||[])).next())}))}function m(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(e){return function(t){return u([e,t])}}function u(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(c){i=[6,c],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}}var h=function(e,t){return v(void 0,void 0,void 0,(function(){var n,r,a;return m(this,(function(i){switch(i.label){case 0:s(t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e()];case 2:return n=i.sent(),r=l(t),[2,n?Object.assign({},{data:n,mark:r}):{mark:r}];case 3:throw a=i.sent(),l(t),a;case 4:return[2]}}))}))};t.clear=u,t.clearAll=f,t.end=l,t.getEntriesByType=p,t.getNavigationMarker=d,t.isNodeJSEnv=n,t.isPerformanceObservableSupported=a,t.isUserTimingAPISupported=r,t.profiler=h,t.start=s,Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,n(260))},2424:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r;!function(e){e.PastedFile="pastedFile",e.PastedScreenshot="pastedScreenshot",e.LocalUpload="localUpload"}(r||(r={}))},2455:function(e,t,n){"use strict";n.d(t,"a",(function(){return te}));var r=n(12),a=n.n(r),i=n(26),o=n.n(i),c=n(9),u=n.n(c),s=n(10),l=n.n(s),f=n(5),p=n.n(f),d=n(15),v=n.n(d),m=n(18),h=n.n(m),y=n(7),b=n.n(y),g=n(1),w=n.n(g),O=n(0),k=n(2403),F=n(2521),P=n(2470),j=n(531);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var a=b()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return h()(this,n)}}var x=function(e){v()(n,e);var t=E(n);function n(){return u()(this,n),t.apply(this,arguments)}return l()(n,[{key:"emitPluginItemsInserted",value:function(e){var t=e.map((function(e){return{pluginName:e.serviceName,pluginFile:{id:e.id,metadata:e.metadata}}}));this.emit("plugin-items-inserted",t)}},{key:"emitUploadsStart",value:function(e){this.emit("uploads-start",{files:e})}},{key:"emitUploadPreviewUpdate",value:function(e,t){this.emit("upload-preview-update",{file:e,preview:t})}},{key:"emitUploadEnd",value:function(e){this.emit("upload-end",{file:e})}},{key:"emitUploadError",value:function(e,t){this.emit("upload-error",{fileId:e,error:t})}}]),n}(function(){function e(){u()(this,e),w()(this,"emitter",new j.EventEmitter2({wildcard:!0}))}return l()(e,[{key:"once",value:function(e,t){this.emitter.once(e,t)}},{key:"on",value:function(e,t){this.emitter.on(e,t)}},{key:"onAny",value:function(e){this.emitter.onAny(e)}},{key:"addListener",value:function(e,t){this.emitter.addListener(e,t)}},{key:"off",value:function(e,t){this.emitter.off(e,t)}},{key:"removeListener",value:function(e,t){this.emitter.removeListener(e,t)}},{key:"removeAllListeners",value:function(e){void 0===e?this.emitter.removeAllListeners():this.emitter.removeAllListeners(e)}},{key:"emit",value:function(e,t){return this.emitter.emit(e,t)}}]),e}()),D=n(310),A=n.n(D),U=n(2596),S=n(2467),C=n(2522),T=n(2376),I=n(2391),L=n(2380),M=n(2457);function R(){return(R=o()(a.a.mark((function e(t,n){var r,i,o,c,u,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(L.c)(t);case 2:return r=e.sent,e.next=5,Object(M.a)(r);case 5:if(null!==(i=e.sent)){e.next=10;break}return e.abrupt("return",{file:t});case 10:return o=i.width,c=i.height,u=i.scaleFactor,s={file:t,dimensions:{width:o,height:c},scaleFactor:n||u},e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=n(2424),z=n(2566),B=function(e){return!e.width&&!e.height};function X(){return(X=o()(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t,e.next="image"===e.t0||"video"===e.t0?3:9;break;case 3:return e.next=5,Object(z.a)(t,n);case 5:if(r=e.sent,!B(r)){e.next=8;break}return e.abrupt("return",{file:n,scaleFactor:1});case 8:return e.abrupt("return",{file:n,dimensions:r,scaleFactor:1});case 9:return e.abrupt("return",{file:n});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Y,W=function(){function e(t,n,r){var i=this;u()(this,e),w()(this,"emit",(function(e,t){i.emitter.emit(e,t)})),w()(this,"onFileSuccess",function(){var e=o()(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.mediaFile,i.emit("file-converting",{file:r}),t.cancel=function(){i.releaseCancellableFile(r)};case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),w()(this,"onFileError",(function(e,t,n){if(i.releaseCancellableFile(e),"canceled"!==n){var r=n instanceof Error?n.message:n,a=n instanceof Error?n:void 0;i.emit("file-upload-error",{fileId:e.id,error:{fileId:e.id,name:t,description:r,rawError:a}})}})),this.tenantMediaClient=t,this.tenantUploadParams=n,this.shouldCopyFileToRecents=r,this.emitter=new j.EventEmitter2,this.cancellableFilesUploads={}}return l()(e,[{key:"setUploadParams",value:function(e){this.tenantUploadParams=e}},{key:"createUploadController",value:function(){return new U.a}},{key:"addFiles",value:function(e){this.addFilesWithSource(e.map((function(e){return{file:e,source:N.a.LocalUpload}})))}},{key:"addFile",value:function(e,t){this.addFilesWithSource([{file:e,source:N.a.LocalUpload,replaceFileId:t}])}},{key:"addFilesWithSource",value:function(e){var t=this;if(0!==e.length){var n=Date.now(),r=this.userMediaClient,a=this.tenantMediaClient,i=this.shouldCopyFileToRecents,o=i?a:r,c=i?this.tenantUploadParams.collection:I.f;if(o){for(var u=[],s=0;s<e.length;s++){var l=e[s].replaceFileId;u.push({fileId:l||A()(),occurrenceKey:A()(),collection:c})}var f=o.file.touchFiles(u,c),p=e.map((function(e,r){var a=e.file,s=e.source,l=u[r],p=l.fileId,d=l.occurrenceKey,v=f.then((function(e){var t=e.created.find((function(e){return e.fileId===p}));if(!t)throw new Error("Cant retrieve uploadId from result of touch endpoint call");return t.uploadId})).catch((function(e){if(e instanceof S.a){var t=e;if(t.metadata&&409===t.metadata.statusCode)return o.mediaStore.createUpload(1,c).then((function(e){return e.data[0].id}))}throw e})),m={collection:c,content:a,name:a.name,mimeType:a.type},h={id:p,occurrenceKey:d,deferredUploadId:v},y=t.createUploadController(),b=o.file.upload(m,y,h),g={id:p,name:a.name,size:a.size,creationDate:n,type:a.type,occurrenceKey:d},w={mediaFile:g,file:a,source:s,cancel:function(){y.abort()}},O=t.onFileSuccess.bind(t);return b.subscribe({next:function(e){"processing"===e.status&&(this.unsubscribe(),i&&(o.emit("file-added",e),C.a.emit("file-added",e)),O(w,p))},error:function(e){t.onFileError(g,"upload_fail",e)}}),t.cancellableFilesUploads[p]=w,w})),d=p.map((function(e){return e.mediaFile}));this.emit("files-added",{files:d}),this.emitPreviews(p)}}}},{key:"cancel",value:function(e){var t=this;if(e){var n=this.cancellableFilesUploads[e];n&&n.cancel&&n.cancel()}else Object.keys(this.cancellableFilesUploads).forEach((function(e){var n=t.cancellableFilesUploads[e];n.cancel&&n.cancel()}))}},{key:"on",value:function(e,t){this.emitter.on(e,t)}},{key:"off",value:function(e,t){this.emitter.off(e,t)}},{key:"emitPreviews",value:function(e){var t=this;e.forEach((function(e){var n=e.file,r=e.mediaFile,a=e.source,i=n.type,o=t.getMediaTypeFromFile(n);Object(T.isMimeTypeSupportedByBrowser)(i)?"image"===o?function(e,t){return R.apply(this,arguments)}(n,a===N.a.PastedScreenshot?window.devicePixelRatio:void 0).then((function(e){t.emit("file-preview-update",{file:r,preview:e})})):function(e,t){return X.apply(this,arguments)}(o,n).then((function(e){t.emit("file-preview-update",{file:r,preview:e})})).catch((function(){return t.emit("file-preview-update",{file:r,preview:{}})})):t.emit("file-preview-update",{file:r,preview:{}})}))}},{key:"getMediaTypeFromFile",value:function(e){var t=e.type;return Object(T.getMediaTypeFromMimeType)(t)}},{key:"releaseCancellableFile",value:function(e){delete this.cancellableFilesUploads[e.id]}}]),e}(),G=n(2386),H=n(222),J=n(529),V=n(2431),_=n(2402);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){w()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=function(e){if(Y)return Y.getInstance(e)},Q=function(e,t){(function(e,t){if(!Y){var n={platform:{component:"media-picker-".concat(t)},type:H.b.Experience,performanceType:H.a.InlineResult,featureFlags:G.b};Y=new J.a("media-upload",n)}return Y.getInstance(e)})(e,t).start()},Z=function(e,t){var n,r=q(q({},t),{},{packageName:_.a,packageVersion:_.b,mediaEnvironment:Object(V.b)(),mediaRegion:Object(V.c)()});null===(n=$(e))||void 0===n||n.failure({metadata:r})};function ee(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=b()(e);if(t){var a=b()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return h()(this,n)}}var te=function(e){v()(n,e);var t=ee(n);function n(e,r){var i;u()(this,n),i=t.call(this,e),w()(p()(i),"uploadComponent",new x),w()(p()(i),"fireCommencedEvent",(function(e){e.files.forEach((function(e){var t=e.id,n=e.size,r=e.type;Object(k.start)("MediaPicker.fireUpload.".concat(t)),i.createAndFireAnalyticsEvent({eventType:"operational",action:"commenced",actionSubject:"mediaUpload",actionSubjectId:"localMedia",attributes:{sourceType:"local",serviceName:"upload",fileAttributes:{fileId:t,fileSize:n,fileMimetype:r}}}),Q(t,i.componentName)}))})),w()(p()(i),"fireUploadSucceeded",(function(e){var t=e.file,n=t.id,r=t.size,a=t.type,o=Object(k.end)("MediaPicker.fireUpload.".concat(n)).duration,c=void 0===o?-1:o;i.createAndFireAnalyticsEvent({eventType:"operational",action:"succeeded",actionSubject:"mediaUpload",actionSubjectId:"localMedia",attributes:{sourceType:"local",serviceName:"upload",status:"success",fileAttributes:{fileId:n,fileSize:r,fileMimetype:a},uploadDurationMsec:c}}),function(e,t){var n;null===(n=$(e))||void 0===n||n.success({metadata:{fileAttributes:t,packageName:_.a,packageVersion:_.b,mediaEnvironment:Object(V.b)(),mediaRegion:Object(V.c)()}})}(n,{fileId:n,fileSize:r,fileMimetype:a})})),w()(p()(i),"fireUploadFailed",function(){var e=o()(a.a.mark((function e(t){var n,r,o,c,u,s,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.fileId,r=t.error,o=r.name,c=r.rawError,u=Object(k.end)("MediaPicker.fireUpload.".concat(n)),s=u.duration,l=void 0===s?-1:s,i.createAndFireAnalyticsEvent({eventType:"operational",action:"failed",actionSubject:"mediaUpload",actionSubjectId:"localMedia",attributes:{sourceType:"local",serviceName:"upload",status:"fail",failReason:o,error:c?Object(F.a)(c):"unknown",request:c?Object(G.d)(c):void 0,fileAttributes:{fileId:n},uploadDurationMsec:l}}),Z(n,{failReason:o,error:c?Object(F.a)(c):"unknown",request:c?Object(G.d)(c):void 0,fileAttributes:{fileId:n},uploadDurationMsec:l});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),w()(p()(i),"createAndFireAnalyticsEvent",(function(e){var t=i.props.createAnalyticsEvent;t&&t(e).fire(P.a)})),w()(p()(i),"cancel",(function(e){i.uploadService.cancel(e)})),w()(p()(i),"onFilesAdded",(function(e){var t=e.files;i.uploadComponent.emitUploadsStart(t)})),w()(p()(i),"onFilePreviewUpdate",(function(e){var t=e.file,n=e.preview;i.uploadComponent.emitUploadPreviewUpdate(t,n)})),w()(p()(i),"onFileConverting",(function(e){var t=e.file;i.uploadComponent.emitUploadEnd(t)})),w()(p()(i),"onUploadError",(function(e){var t=e.fileId,n=e.error;i.uploadComponent.emitUploadError(t,n)})),i.componentName=r;var c=i.props,s=c.mediaClient,l=c.config,f=c.onUploadsStart,d=c.onPreviewUpdate,v=c.onEnd,m=c.onError,h=l.uploadParams,y=l.shouldCopyFileToRecents,b=void 0===y||y;return i.uploadComponent.on("uploads-start",i.fireCommencedEvent),i.uploadComponent.on("upload-end",i.fireUploadSucceeded),i.uploadComponent.on("upload-error",i.fireUploadFailed),f&&i.uploadComponent.on("uploads-start",f),d&&i.uploadComponent.on("upload-preview-update",d),v&&i.uploadComponent.on("upload-end",v),m&&i.uploadComponent.on("upload-error",m),i.uploadService=new W(s,h,b),i.uploadService.on("files-added",i.onFilesAdded),i.uploadService.on("file-preview-update",i.onFilePreviewUpdate),i.uploadService.on("file-converting",i.onFileConverting),i.uploadService.on("file-upload-error",i.onUploadError),i}return l()(n,[{key:"setUploadParams",value:function(e){this.uploadService.setUploadParams(e)}}]),n}(O.Component)},2457:function(e,t,n){"use strict";n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return M}));var r,a,i=n(12),o=n.n(i),c=n(26),u=n.n(c);!function(e){e.JPEG="image/jpeg",e.PNG="image/png"}(r||(r={})),function(e){e.XResolution="XResolution",e.YResolution="YResolution",e.Orientation="Orientation"}(a||(a={}));var s,l={"top-left":1,"top-right":2,"bottom-right":3,"bottom-left":4,"left-top":5,"right-top":6,"right-bottom":7,"left-bottom":8},f=n(1),p=n.n(f),d=n(59),v=n.n(d),m=a.XResolution,h=a.YResolution;function y(e){return new Promise(function(){var t=u()(o.a.mark((function t(r,a){var i;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=5;break}return t.next=3,n.e(167).then(n.t.bind(null,3224,7));case 3:i=t.sent,s=i.default||i;case 5:s.parseMetaData(e,(function(e){try{var t=e&&e.exif?e.exif.getAll():{};Object.keys(t).forEach((function(e){var n=t[e];"object"!==v()(n)||e!==m&&e!==h||!("numerator"in n)||(t[e]=n.numerator),"number"===typeof t[e]&&(t[e]="".concat(t[e]))})),r(t)}catch(n){a(n)}}));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}var b,g=n(2380);function w(e){return O.apply(this,arguments)}function O(){return O=u()(o.a.mark((function e(t){var r,a,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b){e.next=5;break}return e.next=3,n.e(178).then(n.t.bind(null,3223,7));case 3:r=e.sent,b=r.default||r;case 5:return e.next=7,Object(g.a)(t);case 7:return a=e.sent,i=b(a),e.next=11,k(i);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function k(e){return F.apply(this,arguments)}function F(){return(F=u()(o.a.mark((function e(t){var n,r,a,i,c,u,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="",r={},a=0;case 3:if(!(a<t.length)){e.next=12;break}if("IEND"!==(i=t[a]).name){e.next=7;break}return e.abrupt("break",12);case 7:"iTXt"===i.name&&(n=String.fromCharCode.apply(null,Array.from(i.data))),"pHYs"===i.name&&(c=new DataView(i.data.buffer),1===c.getUint8(8)&&(u=c.getUint32(0),s=c.getUint32(4),r={PixelPerUnitX:u,PixelPerUnitY:s}));case 9:++a,e.next=3;break;case 12:return e.abrupt("return",{iTXt:n,pHYs:r});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){var t={},n=e.match(/<(tiff|exif):.+>/gi);return n&&n.forEach((function(e){var n=e.match(/<(tiff|exif):([^>]+)>([^<]+)/i);if(n){var r=n[2];t[r]=n[3]}})),t}function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e){return D.apply(this,arguments)}function D(){return(D=u()(o.a.mark((function e(t){var n,a,i,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.type,e.prev=1,n!==r.PNG){e.next=12;break}return e.next=5,w(t);case 5:return a=e.sent,i=a.iTXt,c=a.pHYs,u=E(E({},P(i)),c),e.abrupt("return",u);case 12:if(t.type!==r.JPEG){e.next=16;break}return e.next=15,y(t);case 15:return e.abrupt("return",e.sent);case 16:e.next=20;break;case 18:e.prev=18,e.t0=e.catch(1);case 20:return e.abrupt("return",null);case 21:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}var A=n(2368),U=a.Orientation,S=a.XResolution;function C(e){return T.apply(this,arguments)}function T(){return(T=u()(o.a.mark((function e(t){var n,r,a,i,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return r=n.width,a=n.height,i=n.tags,c=I(t.file,i),e.abrupt("return",{scaleFactor:c,width:r,height:a});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t){var n=function(e){try{var t=e.name.trim().match(/@([0-9\.]+)x\.[a-z]{3}$/);if(t)return parseFloat(t[1])}catch(n){}return null}(e);return null!==n?n:t?"number"===typeof t.PixelPerUnitX?Math.round(.0254*t.PixelPerUnitX)/72:N(t,S,72)/72:1}var L=function(e){if(e&&e[U]){var t=e[U];if(t){var n=parseInt(t,10);return isNaN(n)?l[t]:n}}return 1};function M(e){return R.apply(this,arguments)}function R(){return(R=u()(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t);case 2:return n=e.sent,e.abrupt("return",L(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t,n){try{var r=parseFloat("".concat(e[t]));if(!isNaN(r))return r}catch(a){}return n}function z(e){return B.apply(this,arguments)}function B(){return(B=u()(o.a.mark((function e(t){var n,r,a,i,c,u,s,l,f,p,d,v,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.file,r=t.src,a=n.type,i=0,c=0,e.next=6,x(n);case 6:if((u=e.sent)&&u.PixelXDimension&&(i=N(u,"PixelXDimension",0)),u&&u.PixelXDimension&&(c=N(u,"PixelYDimension",0)),s=L(u),l=Object(A.b)(s),f={type:a,width:i,height:c,naturalWidth:i,naturalHeight:c,tags:u},!(l||0===i&&0===c)){e.next=27;break}return e.prev=13,e.next=16,Object(g.e)(r);case 16:p=e.sent,d=Object(g.f)(p),v=d.width,m=d.height,f.width=v,f.height=m,f.naturalWidth=p.naturalWidth,f.naturalHeight=p.naturalHeight,e.next=27;break;case 24:return e.prev=24,e.t0=e.catch(13),e.abrupt("return",null);case 27:return e.abrupt("return",f);case 28:case"end":return e.stop()}}),e,null,[[13,24]])})))).apply(this,arguments)}},2470:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="media"},2567:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(28),a=n.n(r),i=n(1),o=n.n(i),c=n(0),u=n.n(c),s=n(1197),l="mediaCtx",f=n(3117);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=function(e,t){return e.reduce((function(e,n){return d(d({},e),{},o()({},n,Object(f.c)(n,t)))}),{})},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){var r=Object(c.forwardRef)((function(r,i){var f=r.featureFlags,p=t.filterFeatureFlags,m=Object(c.useMemo)((function(){var t={featureFlags:p&&f?v(p,f):f};return d(d({},e),{},o()({},l,d({},t)))}),[p,f]);return u.a.createElement(s.a,{data:m},u.a.createElement(n,a()({},r,{ref:i})))}));return r.displayName="WithMediaAnalyticsContext(".concat(n.displayName||n.name,")"),r}}},3325:function(e,t,n){"use strict";n.r(t),n.d(t,"DropzoneBase",(function(){return R})),n.d(t,"Dropzone",(function(){return N}));var r,a=n(12),i=n.n(a),o=n(26),c=n.n(o),u=n(9),s=n.n(u),l=n(10),f=n.n(l),p=n(5),d=n.n(p),v=n(15),m=n.n(v),h=n(18),y=n.n(h),b=n(7),g=n.n(b),w=n(1),O=n.n(w),k=n(506),F=n(3117),P=n(2470),j=n(2567);function E(e){var t=void 0!==e?e:navigator;if(void 0!==e&&(r=void 0),void 0===r){if("undefined"!==typeof t){var n=/Edge\/(\d+)/.exec(t.userAgent),a=/MSIE \d/.test(t.userAgent),i=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(t.userAgent),o=/Opera/.test(t.platform)||/OPR/.test(t.platform),c=!!(a||i||n),u=/Firefox/.test(t.userAgent);return!c&&!o&&!u}return!1}return r}var x=n(44),D=function(e){return[].concat.apply([],e)},A=function e(t){return t.isDirectory?function(e){return new Promise((function(t){e.createReader().readEntries(t)}))}(t).then((function(t){var n=t.map(e);return Promise.all(n).then((function(e){return D(e)}))})):Promise.resolve([t])},U=function(e){var t,n=(t=e,[].slice.call(t,0)).map((function(e){var t=e.webkitGetAsEntry();return A(t)}));return Promise.all(n).then((function(e){return D(e)}))},S=function(e){return new Promise((function(t){var n=[];e.forEach((function(r){r.file((function(r){n.push(r),n.length===e.length&&t(n)}))}))}))},C=(function(){function e(e,t){var n=this;this.onDrop=function(e){return Object(x.b)(n,void 0,void 0,(function(){var t,n,r;return Object(x.d)(this,(function(a){switch(a.label){case 0:return e.preventDefault(),t=this.callback,n=e.dataTransfer.items,[4,U(n)];case 1:return r=a.sent(),t(r),[2]}}))}))},this.dropzone=e,this.callback=t}e.prototype.subscribe=function(){var e=this.dropzone;e.addEventListener("dragover",this.onDragOver,!1),e.addEventListener("drop",this.onDrop)},e.prototype.onDragOver=function(e){e.preventDefault()}}(),n(2455)),T=n(2386);function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=g()(e);if(t){var a=g()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return y()(this,n)}}function L(e){if(!e.dataTransfer)return!1;var t=e.dataTransfer.types;return Array.from(t).indexOf("Files")>-1}var M="dropzone",R=function(e){m()(n,e);var t=I(n);function n(e){var r;return s()(this,n),r=t.call(this,e,M),O()(d()(r),"uiActive",!1),O()(d()(r),"addContainerListeners",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.getContainer();e.addEventListener("dragover",r.onDragOver,!1),e.addEventListener("dragleave",r.onDragLeave,!1),e.addEventListener("drop",r.onFileDropped)})),O()(d()(r),"removeContainerListeners",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.getContainer();e.removeEventListener("dragover",r.onDragOver,!1),e.removeEventListener("dragleave",r.onDragLeave,!1),e.removeEventListener("drop",r.onFileDropped)})),O()(d()(r),"onDragOver",(function(e){if(e.preventDefault(),e.dataTransfer&&L(e)){var t,n=e.dataTransfer;try{t=n.effectAllowed}catch(i){}n.dropEffect="move"===t||"linkMove"===t?"move":"copy";var a=r.getDraggedItemsLength(n);e.stopPropagation(),r.emitDragOver({length:a})}})),O()(d()(r),"onDragLeave",(function(e){if(e.dataTransfer){e.preventDefault();var t=0;if(L(e)){var n=e.dataTransfer;t=r.getDraggedItemsLength(n)}r.emitDragLeave({length:t})}})),O()(d()(r),"onFileDropped",function(){var e=c()(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.dataTransfer){e.next=2;break}return e.abrupt("return");case 2:if(t.preventDefault(),t.stopPropagation(),!E()||!Object(F.c)("folderUploads",r.props.featureFlags)){e.next=13;break}return r.fireAnalyticsForFolders(t.dataTransfer.items),e.next=8,r.getFilesFromDragEvent(t.dataTransfer.items);case 8:n=e.sent,r.onDropFolders(n.length),r.uploadService.addFiles(n),e.next=16;break;case 13:r.onDrop(t),a=Array.from(t.dataTransfer.files),r.uploadService.addFiles(a);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),O()(d()(r),"fireAnalyticsForFolders",(function(e){var t=Array.from(e),n=t.filter((function(e){return function(e){var t;return null===(t=e.webkitGetAsEntry())||void 0===t?void 0:t.isDirectory}(e)})).length;n>0&&r.fireAnalyticsEvent("folderDroppedInto",n)})),O()(d()(r),"getFilesFromDragEvent",function(){var e=c()(i.a.mark((function e(t){var n,a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,e.next=3,U(n);case 3:return a=e.sent,e.next=6,S(a);case 6:return o=e.sent,e.abrupt("return",r.filterFilesAgainstBlacklist(o));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),O()(d()(r),"filterFilesAgainstBlacklist",(function(e){var t=[".DS_Store","thumbs.db","desktop.ini"];return e.filter((function(e){return!t.includes(e.name)}))})),O()(d()(r),"onDropFolders",(function(e){e>0&&r.sendAnalyticsAndEmitDragLeave(e)})),O()(d()(r),"onDrop",(function(e){if(e.dataTransfer&&L(e)){var t=e.dataTransfer,n=r.getDraggedItemsLength(t);r.sendAnalyticsAndEmitDragLeave(n)}})),O()(d()(r),"sendAnalyticsAndEmitDragLeave",(function(e){r.fireAnalyticsEvent("droppedInto",e),r.props.onDrop&&r.props.onDrop(),r.emitDragLeave({length:e})})),r}return f()(n,[{key:"getContainer",value:function(){return this.props.config.container||document.body}},{key:"componentDidMount",value:function(){var e=this.props.onCancelFn;this.addContainerListeners(this.getContainer()),e&&e(this.cancel)}},{key:"componentWillUnmount",value:function(){this.removeContainerListeners(this.getContainer())}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.config.container,n=this.props.config.container;t!==n&&(this.removeContainerListeners(n),this.addContainerListeners(t))}},{key:"getDraggedItemsLength",value:function(e){return e.items?Array.from(e.items).filter((function(e){return"file"===e.kind})).length:e.files.length}},{key:"emitDragOver",value:function(e){if(!this.uiActive){var t=this.props.onDragEnter;this.uiActive=!0,this.fireAnalyticsEvent("draggedInto",e.length),t&&t(e)}}},{key:"emitDragLeave",value:function(e){var t=this;this.uiActive&&(this.uiActive=!1,window.setTimeout((function(){if(!t.uiActive){var n=t.props.onDragLeave;t.fireAnalyticsEvent("draggedOut",e.length),n&&n(e)}}),50))}},{key:"fireAnalyticsEvent",value:function(e,t){var n=this.props.createAnalyticsEvent;n&&n({eventType:"ui",actionSubject:"dropzone",action:e,attributes:{fileCount:t}}).fire(P.a)}},{key:"render",value:function(){return null}}]),n}(C.a),N=Object(j.a)(Object(T.c)(M),{filterFeatureFlags:T.a})(Object(k.a)()(R))}}]);