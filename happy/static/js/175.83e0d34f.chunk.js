(this["webpackJsonphappy-author"]=this["webpackJsonphappy-author"]||[]).push([[175],{2365:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(9),a=n.n(r),i=n(10),c=n.n(i),o=n(5),u=n.n(o),s=n(15),l=n.n(s),f=n(18),p=n.n(f),h=n(7),v=n.n(h),b=n(1),d=n.n(b),m=n(0),y=n.n(m),g=n(805),x=n(2088),k=n(2363),w=n.n(k),O=n(855),j=n(2362),P=n(2356),R=n(2385);function U(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return p()(this,n)}}var S=function(e){l()(n,e);var t=U(n);function n(){var e;a()(this,n);for(var r=arguments.length,i=new Array(r),c=0;c<r;c++)i[c]=arguments[c];return e=t.call.apply(t,[this].concat(i)),d()(u()(e),"state",e.getInitialState()),d()(u()(e),"onMediaDisplayed",(function(){var t=e.props.item;O.a.emit("media-viewed",{fileId:t.id,viewingLevel:"full"})})),e}return c()(n,[{key:"componentDidMount",value:function(){this.init()}},{key:"componentWillUnmount",value:function(){this.release()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.needsReset(e,this.props)&&(this.release(),this.setState(this.initialState))}},{key:"componentDidUpdate",value:function(e){this.needsReset(e,this.props)&&this.init()}},{key:"render",value:function(){var e=this;return this.state.content.match({pending:function(){return y.a.createElement(P.a,null)},successful:function(t){return e.renderSuccessful(t)},failed:function(t){var n=e.props.item;return y.a.createElement(j.a,{fileId:n.id,fileState:n,error:t,supressAnalytics:!0},y.a.createElement("p",null,y.a.createElement(g.a,x.a.try_downloading_file)),e.renderDownloadButton(t))}})}},{key:"getInitialState",value:function(){return this.initialState}},{key:"renderDownloadButton",value:function(e){var t=this.props,n=t.item,r=t.mediaClient,a=t.collectionName;return y.a.createElement(R.b,{fileState:n,mediaClient:r,error:e,collectionName:a})}},{key:"needsReset",value:function(e,t){return!w()(e.item,t.item)||e.mediaClient!==t.mediaClient||e.collectionName!==t.collectionName}}]),n}(y.a.Component)},2435:function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return L}));var r,a,i=n(12),c=n.n(i),o=n(25),u=n.n(o);!function(e){e.JPEG="image/jpeg",e.PNG="image/png"}(r||(r={})),function(e){e.XResolution="XResolution",e.YResolution="YResolution",e.Orientation="Orientation"}(a||(a={}));var s,l={"top-left":1,"top-right":2,"bottom-right":3,"bottom-left":4,"left-top":5,"right-top":6,"right-bottom":7,"left-bottom":8},f=n(1),p=n.n(f),h=n(59),v=n.n(h),b=a.XResolution,d=a.YResolution;function m(e){return new Promise(function(){var t=u()(c.a.mark((function t(r,a){var i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s){t.next=5;break}return t.next=3,n.e(167).then(n.t.bind(null,3202,7));case 3:i=t.sent,s=i.default||i;case 5:s.parseMetaData(e,(function(e){try{var t=e&&e.exif?e.exif.getAll():{};Object.keys(t).forEach((function(e){var n=t[e];"object"!==v()(n)||e!==b&&e!==d||!("numerator"in n)||(t[e]=n.numerator),"number"===typeof t[e]&&(t[e]="".concat(t[e]))})),r(t)}catch(n){a(n)}}));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}var y,g=n(2358);function x(e){return k.apply(this,arguments)}function k(){return k=u()(c.a.mark((function e(t){var r,a,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y){e.next=5;break}return e.next=3,n.e(178).then(n.t.bind(null,3201,7));case 3:r=e.sent,y=r.default||r;case 5:return e.next=7,Object(g.a)(t);case 7:return a=e.sent,i=y(a),e.next=11,w(i);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function w(e){return O.apply(this,arguments)}function O(){return(O=u()(c.a.mark((function e(t){var n,r,a,i,o,u,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="",r={},a=0;case 3:if(!(a<t.length)){e.next=12;break}if("IEND"!==(i=t[a]).name){e.next=7;break}return e.abrupt("break",12);case 7:"iTXt"===i.name&&(n=String.fromCharCode.apply(null,Array.from(i.data))),"pHYs"===i.name&&(o=new DataView(i.data.buffer),1===o.getUint8(8)&&(u=o.getUint32(0),s=o.getUint32(4),r={PixelPerUnitX:u,PixelPerUnitY:s}));case 9:++a,e.next=3;break;case 12:return e.abrupt("return",{iTXt:n,pHYs:r});case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){var t={},n=e.match(/<(tiff|exif):.+>/gi);return n&&n.forEach((function(e){var n=e.match(/<(tiff|exif):([^>]+)>([^<]+)/i);if(n){var r=n[2];t[r]=n[3]}})),t}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){p()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e){return S.apply(this,arguments)}function S(){return(S=u()(c.a.mark((function e(t){var n,a,i,o,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.type,e.prev=1,n!==r.PNG){e.next=12;break}return e.next=5,x(t);case 5:return a=e.sent,i=a.iTXt,o=a.pHYs,u=R(R({},j(i)),o),e.abrupt("return",u);case 12:if(t.type!==r.JPEG){e.next=16;break}return e.next=15,m(t);case 15:return e.abrupt("return",e.sent);case 16:e.next=20;break;case 18:e.prev=18,e.t0=e.catch(1);case 20:return e.abrupt("return",null);case 21:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}var E=n(2346),I=a.Orientation,D=a.XResolution;function N(e){return B.apply(this,arguments)}function B(){return(B=u()(c.a.mark((function e(t){var n,r,a,i,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y(t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return r=n.width,a=n.height,i=n.tags,o=X(t.file,i),e.abrupt("return",{scaleFactor:o,width:r,height:a});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t){var n=function(e){try{var t=e.name.trim().match(/@([0-9\.]+)x\.[a-z]{3}$/);if(t)return parseFloat(t[1])}catch(n){}return null}(e);return null!==n?n:t?"number"===typeof t.PixelPerUnitX?Math.round(.0254*t.PixelPerUnitX)/72:F(t,D,72)/72:1}var C=function(e){if(e&&e[I]){var t=e[I];if(t){var n=parseInt(t,10);return isNaN(n)?l[t]:n}}return 1};function L(e){return A.apply(this,arguments)}function A(){return(A=u()(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t);case 2:return n=e.sent,e.abrupt("return",C(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n){try{var r=parseFloat("".concat(e[t]));if(!isNaN(r))return r}catch(a){}return n}function Y(e){return H.apply(this,arguments)}function H(){return(H=u()(c.a.mark((function e(t){var n,r,a,i,o,u,s,l,f,p,h,v,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.file,r=t.src,a=n.type,i=0,o=0,e.next=6,U(n);case 6:if((u=e.sent)&&u.PixelXDimension&&(i=F(u,"PixelXDimension",0)),u&&u.PixelXDimension&&(o=F(u,"PixelYDimension",0)),s=C(u),l=Object(E.b)(s),f={type:a,width:i,height:o,naturalWidth:i,naturalHeight:o,tags:u},!(l||0===i&&0===o)){e.next=27;break}return e.prev=13,e.next=16,Object(g.e)(r);case 16:p=e.sent,h=Object(g.f)(p),v=h.width,b=h.height,f.width=v,f.height=b,f.naturalWidth=p.naturalWidth,f.naturalHeight=p.naturalHeight,e.next=27;break;case 24:return e.prev=24,e.t0=e.catch(13),e.abrupt("return",null);case 27:return e.abrupt("return",f);case 28:case"end":return e.stop()}}),e,null,[[13,24]])})))).apply(this,arguments)}},3205:function(e,t,n){"use strict";n.r(t),n.d(t,"ImageViewer",(function(){return N}));var r=n(25),a=n.n(r),i=n(9),c=n.n(i),o=n(10),u=n.n(o),s=n(5),l=n.n(s),f=n(15),p=n.n(f),h=n(18),v=n.n(h),b=n(7),d=n.n(b),m=n(1),y=n.n(m),g=n(12),x=n.n(g),k=n(0),w=n.n(k),O=n(241),j=n(333),P=n(163),R=n(2073),U=n(2435),S=n(3179),E=n(2349),I=n(2547);function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d()(e);if(t){var a=d()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return v()(this,n)}}var N=function(e){p()(n,e);var t=D(n);function n(){var e;c()(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e=t.call.apply(t,[this].concat(a)),y()(l()(e),"onLoad",(function(){e.props.onLoad(),e.onMediaDisplayed()})),y()(l()(e),"onImgError",(function(){e.props.onError(new E.b("imageviewer-src-onerror"))})),e}return u()(n,[{key:"initialState",get:function(){return{content:S.a.pending()}}},{key:"init",value:function(){var e=a()(x.a.mark((function e(){var t,n,r,a,i,c,o,u,s,l,f,p,h,v,b,d;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,n=t.item,r=t.mediaClient,a=t.collectionName,"error"!==n.status){e.next=3;break}return e.abrupt("return");case 3:if(e.prev=3,i=1,u=!1,!(s=n.preview)){e.next=24;break}return e.next=10,s;case 10:if(l=e.sent,f=l.value,p=l.origin,!(f instanceof Blob)){e.next=21;break}return e.next=16,Object(U.b)(f);case 16:i=e.sent,c=URL.createObjectURL(f),u="local"===p,e.next=22;break;case 21:c=f;case 22:e.next=38;break;case 24:if(!Object(O.c)(n)){e.next=36;break}return h={type:"file",details:{id:n.id}},v="undefined"!==typeof AbortController?new AbortController:void 0,b=r.getImage(h.details.id,{collection:a,mode:"fit"},v,!0),this.cancelImageFetch=function(){return v&&v.abort()},e.t0=URL,e.next=32,b;case 32:e.t1=e.sent,c=e.t0.createObjectURL.call(e.t0,e.t1),e.next=38;break;case 36:return this.setState({content:S.a.pending()}),e.abrupt("return");case 38:if(u||Object(O.a)(n)||"uploading"===n.status||"image"!==n.mediaType||!Object(j.isImageMimeTypeSupportedByBrowser)(n.mimeType)){e.next=42;break}return e.next=41,r.file.getFileBinaryURL(n.id,a);case 41:o=e.sent;case 42:this.setState({content:S.a.successful({objectUrl:c,orientation:i,originalBinaryImageUrl:o})}),e.next=48;break;case 45:e.prev=45,e.t2=e.catch(3),Object(P.f)(e.t2)||(d=new E.b("imageviewer-fetch-url",e.t2),this.setState({content:S.a.failed(d)}),this.props.onError(d));case 48:case"end":return e.stop()}}),e,this,[[3,45]])})));return function(){return e.apply(this,arguments)}}()},{key:"release",value:function(){var e=this;this.cancelImageFetch&&this.cancelImageFetch(),this.state.content.whenSuccessful((function(t){var n=t.objectUrl;e.revokeObjectUrl(n)}))}},{key:"revokeObjectUrl",value:function(e){URL.revokeObjectURL(e)}},{key:"renderSuccessful",value:function(e){var t=this.props,n=t.item,r=t.onClose,a=t.contextId,i=t.collectionName,c=a?Object(R.a)(e.objectUrl,{id:n.id,contextId:a,collection:i}):e.objectUrl;return w.a.createElement(I.a,{onLoad:this.onLoad,onError:this.onImgError,src:c,originalBinaryImageSrc:e.originalBinaryImageUrl,orientation:e.orientation,onClose:r})}}]),n}(n(2365).a)}}]);