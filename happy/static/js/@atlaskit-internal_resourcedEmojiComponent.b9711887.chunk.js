(this["webpackJsonphappy-author"]=this["webpackJsonphappy-author"]||[]).push([[112],{3336:function(e,t,o){"use strict";o.r(t),o.d(t,"ResourcedEmojiComponent",(function(){return b}));var a,i=o(23),n=o.n(i),c=o(0),r=o.n(c),d=o(133),m=o(167),s=o(103),h=o(683),u=o(610),j=o(276),l=o(884),f=o(13),I=o(115),O=function(e){var t=e.maxSize,o=void 0===t?d.h:t,a=e.representation,i=e.showTooltip,r=e.imageUrl,m=e.showImageBeforeLoad,s=e.emojiId,h=e.onImageLoadError,u=s.shortName,j=Object(c.useState)(!1),l=n()(j,2),O=l[0],b=l[1],E=Object(c.useMemo)((function(){return a?{width:o/(a.height*a.width),height:o}:{width:o,height:o}}),[o,a]),T={minWidth:"".concat(E.width,"px"),width:"".concat(E.width,"px"),height:"".concat(E.height,"px")},p=Object(c.useMemo)((function(){return m||O?"initial":"hidden"}),[O,m]);return Object(f.d)("span",{"data-testid":"emoji-image-".concat(u),"aria-label":u,className:"".concat(I.r," ").concat(I.t," ").concat(I.q),style:T,css:[I.n,I.y],title:i?u:""},Object(f.d)("img",{className:"emoji",alt:u,onLoad:function(){return b(!0)},onError:function(){return b(!1),void(h&&h())},src:r,style:{objectFit:"contain",visibility:p},width:E.width,height:E.height,loading:"lazy"}))};!function(e){e.INITIAL="INITIAL",e.OPTIMISTIC="OPTIMISTIC",e.FALLBACK="FALLBACK",e.EMOJI="EMOJI"}(a||(a={}));var b=function(e){var t=e.emojiProvider,o=e.emojiId,i=e.showTooltip,f=void 0!==i&&i,I=e.customFallback,b=void 0===I?void 0:I,E=e.fitToHeight,T=void 0===E?d.h:E,p=e.optimistic,A=void 0!==p&&p,N=e.optimisticImageURL,g=void 0===N?void 0:N,v=o.shortName,M=o.id,L=o.fallback,w={emoji:{emojiProvider:t}},C=Object(c.useState)(),S=n()(C,2),k=S[0],y=S[1],F=Object(c.useState)(!1),D=n()(F,2),P=D[0],x=D[1];Object(c.useEffect)((function(){o&&(Object(j.a)(Object(j.c)(o),s.d.FMP_END)||Object(j.c)(o).markFMP())}),[o]),Object(c.useMemo)((function(){t&&o&&function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.fetchByEmojiId(t,o);Object(j.c)(t).mark(s.d.METADATA_START),Object(m.n)(a)?(x(!1),a.then((function(e){y(e),e||(Object(j.c)(t).failure({metadata:{reason:"failed to find",source:"ResourcedEmojiComponent",data:{emoji:{id:t.id,shortName:t.shortName}}}}),Object(j.c)(t).mark(s.d.METADATA_END),e||Object(j.c)(t).failure({metadata:{reason:"failed to find",source:"ResourcedEmojiComponent",data:{emoji:{id:t.id,shortName:t.shortName}}}}))})).catch((function(){y(void 0),Object(j.c)(t).failure({metadata:{reason:"failed to load",source:"ResourcedEmojiComponent",data:{emoji:{id:t.id,shortName:t.shortName}}}})})).finally((function(){x(!0),Object(j.c)(t).mark(s.d.METADATA_END)}))):(y(a),x(!0),Object(j.c)(t).mark(s.d.METADATA_END))}(t,o,A)}),[t,o,A]);var R=Object(c.useMemo)((function(){return k||P||g?k||P||!g?!k&&P?a.FALLBACK:a.EMOJI:a.OPTIMISTIC:a.INITIAL}),[k,P,g]);return r.a.createElement(l.a,{emojiContextValue:w},r.a.createElement("span",{"data-emoji-id":M,"data-emoji-short-name":v,"data-emoji-text":L||v},R===a.INITIAL&&r.a.createElement(u.a,{shortName:v,showTooltip:f,size:T||d.h,loading:!0}),R===a.OPTIMISTIC&&g&&r.a.createElement(O,{emojiId:o,imageUrl:g,maxSize:T||d.h}),R===a.FALLBACK&&r.a.createElement(r.a.Fragment,null,b||L||v),R===a.EMOJI&&k&&r.a.createElement(h.a,{emoji:k,onLoadError:function(e){Object(j.c)(e).failure({metadata:{reason:"load error",source:"ResourcedEmojiComponent",data:{emoji:{id:e.id,shortName:e.shortName}}}})},showTooltip:f,fitToHeight:T})))};t.default=b}}]);