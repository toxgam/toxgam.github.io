(this["webpackJsonphappy-author"]=this["webpackJsonphappy-author"]||[]).push([[157],{104:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(740),t),o(n(1610),t),o(n(979),t),o(n(742),t),o(n(980),t),o(n(1614),t)},1175:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(131),o=n(1176),a=n.n(o);function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.category||e.toString(),c=n.lifespan||1e4,i=[o].concat(Object(r.a)(t)),s=function(){return e.apply(null,t)};return a()(s,i,c)}},1265:function(e,t,n){"use strict";n.r(t),n.d(t,"DocShow",(function(){return ae})),n.d(t,"ContextedEditor",(function(){return he})),n.d(t,"Editor",(function(){return fe})),n.d(t,"macrosToDoc",(function(){return E}));var r=n(96),o=n(442),a=n(633),c=n(0),i=n(611),s=n(2325),u=n(2315),l=n(2329),d=n(1262),p=n.n(d),f=n(104),b=n(2318),j=n(2302),h=n(1264);var m=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),O=function(){return O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},O.apply(this,arguments)};function v(e,t){return e.replace(";base64",";name=".concat(encodeURIComponent(t),";base64"))}function y(e){var t=e.name,n=e.size,r=e.type;return new Promise((function(o,a){var c=new window.FileReader;c.onerror=a,c.onload=function(e){o({dataURL:v(e.target.result,t),name:t,size:n,type:r})},c.readAsDataURL(e)}))}function g(e){var t=e.filesInfo;return 0===t.length?null:Object(r.jsx)("ul",O({className:"file-info"},{children:t.map((function(e,t){var n=e.name,o=e.size,a=e.type;return Object(r.jsxs)("li",{children:[Object(r.jsx)("strong",{children:n})," (",a,", ",o," bytes)",Object(r.jsx)("br",{}),Object(r.jsx)("button",O({onClick:function(){return function(e,t){var n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}(e.name,e.dataURL)}},{children:"Download"}))]},t)}))}))}function x(e){return e.filter((function(e){return"undefined"!==typeof e})).map((function(e){var t=function(e){var t,n=e.split(","),r=n[0].split(";"),o=r[0].replace("data:",""),a=r.filter((function(e){return"name"===e.split("=")[0]}));t=1!==a.length?"unknown":a[0].split("=")[1];for(var c=atob(n[1]),i=[],s=0;s<c.length;s++)i.push(c.charCodeAt(s));return{blob:new window.Blob([new Uint8Array(i)],{type:o}),name:t}}(e),n=t.blob;return{name:t.name,size:n.size,type:n.type,dataURL:e}}))}var k=function(e){function t(t){var n=e.call(this,t)||this;n.onChange=function(e){var t,r=n.props,o=r.multiple,a=r.onChange;(t=e.target.files,Promise.all([].map.call(t,y))).then((function(e){var t={values:e.map((function(e){return e.dataURL})),filesInfo:e};n.setState(t,(function(){a(o?t.values:t.values[0])}))}))};var r=t.value,o=Array.isArray(r)?r:[r];return n.state={values:o,filesInfo:x(o)},n}return m(t,e),t.prototype.shouldComponentUpdate=function(e,t){return function(e,t,n){var r=e.props,o=e.state;return!I(r,t)||!I(o,n)}(this,e,t)},t.prototype.render=function(){var e=this,t=this.props,n=t.multiple,o=t.id,a=t.readonly,c=t.disabled,i=t.autofocus,s=t.options,u=this.state.filesInfo;return Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:Object(r.jsx)("input",{ref:function(t){return e.inputRef=t},id:o,type:"file",disabled:a||c,onChange:this.onChange,defaultValue:"",autoFocus:i,multiple:n,accept:s.accept})}),Object(r.jsx)(g,{filesInfo:u})]})},t}(c.Component);k.defaultProps={autofocus:!1};var w=k;function I(e,t,n,r){if(void 0===n&&(n=[]),void 0===r&&(r=[]),e===t)return!0;if("function"===typeof e||"function"===typeof t)return!0;if("object"!==typeof e||"object"!==typeof t)return!1;if(null===e||null===t)return!1;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(e instanceof RegExp&&t instanceof RegExp)return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(A(e)||A(t)){if(!A(e)||!A(t))return!1;var o=Array.prototype.slice;return I(o.call(e),o.call(t),n,r)}if(e.constructor!==t.constructor)return!1;var a=Object.keys(e),c=Object.keys(t);if(0===a.length&&0===c.length)return!0;if(a.length!==c.length)return!1;for(var i=n.length;i--;)if(n[i]===e)return r[i]===t;n.push(e),r.push(t),a.sort(),c.sort();for(var s=a.length-1;s>=0;s--)if(a[s]!==c[s])return!1;for(var u=void 0,l=a.length-1;l>=0;l--)if(!I(e[u=a[l]],t[u],n,r))return!1;return n.pop(),r.pop(),!0}function A(e){return"[object Arguments]"===Object.prototype.toString.call(e)}var C=n(17),S=n(465),P=n(1267),M=n(672),T=new P.a(S.a),q=new M.a(S.a),D=function(){function e(){}return e.prototype.encode=function(e){return T.encode(e)},e.prototype.parse=function(e){return q.parse(e)},e}();function z(e){var t=[],n=[];function r(){var e=function(e){if(0===e.length)return null;var t={version:1,type:"doc",content:e},n=C.Node.fromJSON(S.a,t),r=F(T.encode(n));if(0===r.length)return null;return{macroType:"mMarkdowns",doc:{text:r}}}(n);e&&t.push(e),n=[]}for(var o=0,a=e.content;o<a.length;o++){var c=a[o];"extension"===c.type?(r(),t.push(B(c))):n.push(c)}return r(),t}function E(e){for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];if("mMarkdowns"===o.macroType){var a=o.doc;q.parse(a.text).forEach((function(e){return t.push(e.toJSON())}))}else{var c=o.macroType,i=o.doc,s=f.shortJsonSchemas[c].title;t.push({type:"extension",attrs:{extensionType:o.macroType,extensionKey:s,parameters:i,layout:"default"}})}}return{version:1,type:"doc",content:t}}function F(e){return e.replaceAll(/[\u21b5\u200c]/g,"").replace(/^\s+|\s+$/g,"")}function B(e){var t=e.attrs;return{macroType:t.extensionType,doc:t.parameters}}var _=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function c(e){try{s(r.next(e))}catch(t){a(t)}}function i(e){try{s(r.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((r=r.apply(e,t||[])).next())}))},L=function(e,t){var n,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,r=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){c.label=a[1];break}if(6===a[0]&&c.label<o[1]){c.label=o[1],o=a;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(a);break}o[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(e,c)}catch(i){a=[6,i],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};for(var Q={},U=0,R=f.collections;U<R.length;U++){var N=R[U];Q[N]={}}for(var G={"ui:widget":"textarea"},J=Object(f.getMarkdownProperties)(),W=0,K=f.collections;W<K.length;W++)for(var V=K[W],$=0,H=J[V];$<H.length;$++){var Y=H[$];Q[V][Y]=G}var Z={FileWidget:w,TextareaWidget:function(e){var t=this;return Object(r.jsxs)(o.a,{children:[Object(r.jsx)("label",{children:e.label}),Object(r.jsx)(a.a,{render:function(n){return Object(r.jsx)(u.a,{shouldFocus:!1,appearance:"comment",allowHelpDialog:!1,allowTables:!0,defaultValue:e.value,contentTransformerProvider:function(){return new D},onChange:function(){return _(t,void 0,void 0,(function(){var t,r;return L(this,(function(o){switch(o.label){case 0:return[4,n.getValue()];case 1:return t=o.sent(),r=F(t),e.onChange(r),[2]}}))}))}})}})]})}},X=function(){return X=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},X.apply(this,arguments)};function ee(e){var t=e.macroType,n=e.params,o=e.formId,a=e.onSave,c=f.shortJsonSchemas[t];return Object(r.jsx)(h.a,X({id:o,autoComplete:"off",schema:c,uiSchema:Q[t],widgets:Z,formData:n,onSubmit:function(e){return null===a||void 0===a?void 0:a(e.formData)}},{children:" "}))}var te=function(){return te=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},te.apply(this,arguments)};function ne(e){var t=e.macroType,n=e.params,o=e.onClose,a="macro-form-".concat(Date.now());return Object(r.jsxs)(b.a,{children:[Object(r.jsx)("div",{style:{marginTop:"1em"}}),Object(r.jsx)(ee,{formId:a,macroType:t,params:n,onSave:function(e){o(e)}}),Object(r.jsxs)(j.a,{children:[Object(r.jsx)(s.a,te({appearance:"primary",type:"submit",form:a},{children:"Save"})),Object(r.jsx)(s.a,te({onClick:function(){o(n)}},{children:"Cancel"}))]})]})}var re=n(1261),oe=n.n(re);function ae(e){var t=e.doc,n=e.sortKeys;return Object(r.jsx)("pre",{children:Object(r.jsx)("code",{children:oe.a.stringify(ce(t),{sortMapEntries:function(e,t){return n.indexOf(e.key.value)-n.indexOf(t.key.value)}})})})}function ce(e){for(var t={},n=0,r=Object.entries(e);n<r.length;n++){var o=r[n],a=o[0],c=o[1];["id","parentId","order"].includes(a)||(t[a]="string"===typeof c?c.length>50?c.substring(0,50)+"...":c:"object"===typeof c?Array.isArray(c)?c:ce(c):c)}return t}function ie(e){var t=e.macro,n=t.macroType,o=t.doc,a=f.shortJsonSchemas[n],c=Object.keys(a.properties);return Object(r.jsx)(ae,{doc:o,sortKeys:c})}function se(e){return f.macroTypes.filter((function(e){return"mMarkdowns"!==e})).map((function(t){return function(e,t){var n=f.shortJsonSchemas[e],o=n.description,a=n.title;return{categories:["Happy"],keywords:["happy"],title:"Happy ".concat(a),type:e,key:a,description:o,icons:{48:function(){return Promise.resolve(p.a)}},modules:{quickInsert:[{key:e,action:{type:"node",key:"default",parameters:f.newDocTemplates[e]}}],nodes:{default:{type:"extension",render:function(){return Promise.resolve(ue)},update:function(n){return new Promise((function(o){var a=function(e){o(e),t(null)};t(Object(r.jsx)(ne,{macroType:e,params:n,onClose:a}))}))}}}}}}(t,e)}))}function ue(e){var t=e.node,n=t.parameters,o={macroType:t.extensionType,doc:n};return Object(r.jsx)(ie,{macro:o})}var le=function(){return le=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},le.apply(this,arguments)},de=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function c(e){try{s(r.next(e))}catch(t){a(t)}}function i(e){try{s(r.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((r=r.apply(e,t||[])).next())}))},pe=function(e,t){var n,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,r=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){c.label=a[1];break}if(6===a[0]&&c.label<o[1]){c.label=o[1],o=a;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(a);break}o[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(e,c)}catch(i){a=[6,i],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};function fe(e){var t=this,n=e.pageId,o=e.before,a=e.actions,d=e.onSave,p=Object(c.useState)(null),f=p[0],b=p[1],j=Object(c.useState)(null),h=j[0],m=j[1];return Object(c.useEffect)((function(){var e=se(m);b(new l.a(e))}),[]),f?Object(r.jsx)(i.b,le({locale:"en"},{children:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(u.a,{shouldFocus:!1,appearance:"comment",allowHelpDialog:!1,allowTables:!0,allowExtension:{allowAutoSave:!1},extensionProviders:[f],defaultValue:E(o),primaryToolbarComponents:d?Object(r.jsx)(s.a,le({appearance:"primary",onClick:function(){return de(t,void 0,void 0,(function(){var e,t,r;return pe(this,(function(c){switch(c.label){case 0:return[4,be(a)];case 1:return e=c.sent(),t=function(e,t,n){for(var r=[],o=[],a=[],c=[],i=function(c){var i=n[c].doc;if(i.parentId=e,i.order=c+1,i.id){var s=t.findIndex((function(e){return e.doc.id===i.id}));if(s<0)i.id="",r.push(c);else I(t[s].doc,i)?a.push(c):o.push(c)}else r.push(c)},s=0;s<n.length;s++)i(s);for(var u=function(e){var r=t[e].doc;o.findIndex((function(e){return n[e].doc.id===r.id}))<0&&(a.findIndex((function(e){return n[e].doc.id===r.id}))<0&&c.push(e))},l=0;l<t.length;l++)u(l);var d=0,p=0;for(;d<r.length&&p<c.length;){var f=r[d],b=n[f];if("mMarkdowns"===b.macroType){var j=c[p],h=t[j];"mMarkdowns"===h.macroType?(b.doc.id=h.doc.id,I(b,h)||o.push(f),r.splice(d,1),c.splice(p,1)):p++}else d++}return{after:n,create:r,update:o,remove:c}}(n,o,e),[4,d(t)];case 2:return r=c.sent(),a.replaceDocument(E(r)),[2]}}))}))}},{children:"Save"})):void 0}),h]})})):null}function be(e){return de(this,void 0,void 0,(function(){return pe(this,(function(t){switch(t.label){case 0:return[4,e.getValue()];case 1:return[2,z(t.sent())]}}))}))}var je=function(){return je=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},je.apply(this,arguments)};function he(e){return Object(r.jsx)(o.a,{children:Object(r.jsx)(a.a,{render:function(t){return Object(r.jsx)(fe,je({},e,{actions:t}))}})})}t.default=he},130:function(e,t,n){"use strict";(function(e){n.d(t,"m",(function(){return j})),n.d(t,"j",(function(){return h})),n.d(t,"n",(function(){return m})),n.d(t,"k",(function(){return O})),n.d(t,"l",(function(){return v})),n.d(t,"f",(function(){return y})),n.d(t,"g",(function(){return x})),n.d(t,"a",(function(){return w})),n.d(t,"c",(function(){return A})),n.d(t,"h",(function(){return S})),n.d(t,"b",(function(){return M})),n.d(t,"e",(function(){return q})),n.d(t,"d",(function(){return F})),n.d(t,"i",(function(){return Q}));var r=n(69),o=n(55),a=n(61),c=n(98),i=n(238),s=n(1175),u=n(104),l=n(332),d=n(329),p=n(821),f=n(624);e.enabledFirestorePersistence||(e.enabledFirestorePersistence=!0,d.b.enablePersistence());var b=9999;function j(e,t,n){var r=G(e).limit(void 0===n?b:2);return void 0!==t&&(r=r.where("parentId","==",t)),Object(l.isOrdered)(e)&&(r=r.orderBy("order","asc"),n&&(r=r.startAfter(n))),Object(i.e)(r,{idField:"id"}).data}function h(e,t){var n=Object(i.d)().collection(Object(l.collectionPath)(e)).doc(t),r=Object(i.f)(n,{idField:"id"}).data;return 1===Object.keys(r).length?void 0:r}function m(e,t,n){return Object(u.useMacros)(t,(function(t,r){return j([e,t],r,n)}))}function O(e,t){var n=K;return Object(s.a)(n,[e,t])}function v(e,t){var n=Object(i.d)().collection(Object(l.collectionPath)(e)).doc(t),r=n.update.bind(n);return function(){var t=Object(c.a)(Object(a.a)().mark((function t(n){var o;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return X(n),t.next=3,ee(e,n);case 3:return o=N(n),t.next=6,r(o);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}function y(e){return g.apply(this,arguments)}function g(){return(g=Object(c.a)(Object(a.a)().mark((function e(t){var n,o,c,i,s,l;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("books",t);case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",void 0);case 5:o={},c=Object(r.a)(u.bookDataCollections),e.prev=7,c.s();case 9:if((i=c.n()).done){e.next=17;break}return s=i.value,e.next=13,J([t,s],void 0);case 13:l=e.sent,o[s]=l;case 15:e.next=9;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(7),c.e(e.t0);case 22:return e.prev=22,c.f(),e.finish(22);case 25:return e.abrupt("return",{book:n,data:o});case 26:case"end":return e.stop()}}),e,null,[[7,19,22,25]])})))).apply(this,arguments)}function x(e,t){return k.apply(this,arguments)}function k(){return(k=Object(c.a)(Object(a.a)().mark((function e(t,n){var r;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(t).doc(n).get();case 2:return r=e.sent,e.abrupt("return",R(r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){return I.apply(this,arguments)}function I(){return(I=Object(c.a)(Object(a.a)().mark((function e(t,n){var r;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return X(n),e.next=3,ee(t,n);case 3:return e.next=5,G(t).add(n);case 5:return r=e.sent,e.abrupt("return",r.id);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t,n){return C.apply(this,arguments)}function C(){return(C=Object(c.a)(Object(a.a)().mark((function e(t,n,r){var o,c,i,s;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object(l.collectionFromPath)(t),c=Object(l.isOrdered)(t),e.t0=Object,e.t1=void 0===n?{}:{parentId:n},e.t2=f.a[o],!c){e.next=16;break}if(e.t4=r,e.t4){e.next=12;break}return e.next=10,$(t,n);case 10:e.t5=e.sent,e.t4=e.t5+1;case 12:e.t6=e.t4,e.t3={order:e.t6},e.next=17;break;case 16:e.t3={};case 17:if(e.t7=e.t3,i=e.t0.assign.call(e.t0,e.t1,e.t2,e.t7),"mListSelects"!==o&&"mListShows"!==o){e.next=27;break}return s=t[0],e.next=23,Y(s);case 23:if(e.t8=e.sent,e.t8){e.next=26;break}e.t8="";case 26:i.listId=e.t8;case 27:return e.next=29,w(t,i);case 29:return e.abrupt("return",e.sent);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,n){return P.apply(this,arguments)}function P(){return(P=Object(c.a)(Object(a.a)().mark((function e(t,n,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return X(r),e.next=3,ee(t,r);case 3:return e.next=5,G(t).doc(n).set(r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,n){return T.apply(this,arguments)}function T(){return(T=Object(c.a)(Object(a.a)().mark((function e(t,n,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(t,n);case 2:if(e.sent){e.next=6;break}return e.next=6,S(t,n,r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,t){return D.apply(this,arguments)}function D(){return(D=Object(c.a)(Object(a.a)().mark((function e(t,n){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.b.runTransaction((function(e){return z(e,t,n)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t,n){return E.apply(this,arguments)}function E(){return E=Object(c.a)(Object(a.a)().mark((function e(t,n,r){var o,i,s,l;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){return(s=Object(c.a)(Object(a.a)().mark((function e(n){var c,i,s;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=[o,n],e.next=3,G(c).where("parentId","==",r).get();case 3:return i=e.sent,s=i.docs.map((function(e){return z(t,c,e.id)})),e.next=7,Promise.all(s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)},i=function(e){return s.apply(this,arguments)},t.delete(G(n).doc(r)),o=n[0],l=u.bookDataCollections.map(i),e.next=7,Promise.all(l);case 7:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}function F(e,t){return B.apply(this,arguments)}function B(){return(B=Object(c.a)(Object(a.a)().mark((function e(t,n){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.b.runTransaction((function(e){return _(e,t,n)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t,n,r){return L.apply(this,arguments)}function L(){return L=Object(c.a)(Object(a.a)().mark((function e(t,n,r,o){var i,s,l,d,p,f,b,j,h,m,O;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m=function(){return(m=Object(c.a)(Object(a.a)().mark((function e(r){var o,c,i,s;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[b,r],c=[j,r],e.next=4,G(o).where("parentId","==",n.id).get();case 4:return i=e.sent,s=i.docs.map((function(e){return _(t,{bookIdAndDataCollection:o,id:e.id},{bookIdAndDataCollection:c,parentId:f},e.data())})),e.next=8,Promise.all(s);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)},h=function(e){return m.apply(this,arguments)},o){e.next=11;break}return i=G(n.bookIdAndDataCollection),s=i.doc(n.id),e.next=7,s.get();case 7:if(l=e.sent,o=l.data()){e.next=11;break}return e.abrupt("return");case 11:return d=G(r.bookIdAndDataCollection).doc(),p=Object.assign({},o,{parentId:r.parentId}),t.set(d,p),f=d.id,b=n.bookIdAndDataCollection[0],j=r.bookIdAndDataCollection[0],O=u.bookDataCollections.map(h),e.next=20,Promise.all(O);case 20:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}function Q(e,t,n){return U.apply(this,arguments)}function U(){return(U=Object(c.a)(Object(a.a)().mark((function e(t,n,r){return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(t).doc(n).update({parentId:r});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){var t=e.data();if(t){var n=t;return n.id=e.id,n}}function N(e){var t=Object.assign({},e);return delete t.id,t}function G(e){return d.b.collection(Object(l.collectionPath)(e))}function J(e,t,n){return W.apply(this,arguments)}function W(){return(W=Object(c.a)(Object(a.a)().mark((function e(t,n,r){var o,c;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=G(t).limit(void 0===r?b:2),void 0!==n&&(o=o.where("parentId","==",n)),Object(l.isOrdered)(t)&&(o=o.orderBy("order","asc"),r&&(o=o.startAfter(r))),e.next=5,o.get();case 5:return c=e.sent,e.abrupt("return",c.docs.map((function(e){return R(e)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t){return V.apply(this,arguments)}function V(){return(V=Object(c.a)(Object(a.a)().mark((function e(t,n){var r,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[];case 1:if(!n){e.next=8;break}return e.next=4,x(t,n);case 4:(o=e.sent)?(r.push(o),n=o.parentId):n="",e.next=1;break;case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t){return H.apply(this,arguments)}function H(){return(H=Object(c.a)(Object(a.a)().mark((function e(t,n){var r,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=G(t).orderBy("order","desc").limit(1),void 0!==n&&(r=r.where("parentId","==",n)),e.next=4,r.get();case 4:return o=e.sent,e.abrupt("return",o.empty?0:o.docs[0].data().order);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(c.a)(Object(a.a)().mark((function e(t){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J([t,"lists"],void 0);case 2:return n=e.sent,e.abrupt("return",0===n.length?void 0:n[0].id);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=Object(o.a)(n[t],2),a=r[0];void 0===r[1]&&(e[a]="")}}function ee(e,t){return te.apply(this,arguments)}function te(){return(te=Object(c.a)(Object(a.a)().mark((function e(t,n){var r,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=600,"mImages"!==(o=Object(l.collectionFromPath)(t))&&"mQuotes"!==o){e.next=8;break}return e.next=5,Object(p.a)(n.image,r);case 5:n.image=e.sent,e.next=12;break;case 8:if("pages"!==o||"string"!==typeof n.visual){e.next=12;break}return e.next=11,Object(p.a)(n.visual,r);case 11:n.visual=e.sent;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,n(186))},1610:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.topPageIds=void 0,t.topPageIds={sidebar:"sidebar",parts:"parts"}},1614:function(e,t,n){"use strict";var r=n(743).default;Object.defineProperty(t,"__esModule",{value:!0}),t.newDocTemplates=void 0;var o=n(740),a=n(980);t.newDocTemplates={},o.collections.forEach((function(e){var n=a.shortJsonSchemas[e].properties;t.newDocTemplates[e]={};for(var o=0,c=Object.entries(n);o<c.length;o++){var i=r(c[o],2),s=i[0],u=i[1];t.newDocTemplates[e][s]=u.default}}))},2048:function(e,t,n){"use strict";n.r(t);var r=n(3),o=n(121),a=n.n(o),c=n(228),i=n(2314),s=n(238),u=n(167),l=n(2245),d=n(2243),p=n(669),f=(n(1601),n(55)),b=n(2328),j=n(2324),h=n(26),m=Object(u.b)({key:"snackbarState",default:{severity:"info",msg:""}});function O(){var e=Object(u.c)(m),t=Object(f.a)(e,2),n=t[0],r=n.severity,o=n.msg,a=t[1];return Object(h.jsx)(b.a,{open:o.length>0,autoHideDuration:3e3,onClose:function(){return a({severity:r,msg:""})},children:Object(h.jsx)(j.a,{severity:r,children:o})})}function v(){var e=Object(u.c)(m),t=Object(f.a)(e,2)[1];return function(e,n){return t({severity:e,msg:n})}}var y=n(2253),g=n(1273),x=Object(y.a)((function(e){return{paper:{marginBottom:e.spacing(2),padding:e.spacing(2)}}}));function k(e){var t=e.children,n=x();return Object(h.jsx)(g.a,{className:n.paper,children:t})}function w(){var e=Object(s.c)(),t=v();return Object(h.jsx)(l.a,{item:!0,md:6,sm:12,children:Object(h.jsx)(k,{children:Object(h.jsx)(p.a,{autoComplete:"off",schema:{type:"object",required:["email","password"],properties:{email:{type:"string",format:"email",title:"Email"},password:{type:"string",title:"Password"}}},uiSchema:{password:{"ui:widget":"password"}},onSubmit:function(n){var r,o,a=n.formData;return r=a.email,o=a.password,void e.signInWithEmailAndPassword(r,o).then((function(){}),(function(e){t("error","Could not login"),console.error(e)}))},children:Object(h.jsx)(d.a,{type:"submit",color:"primary",children:"Login"})})})})}var I=n(329),A=n(162),C=n(834),S=n(130),P=n(131),M=n(61),T=n(98),q=n(104),D=n(624),z=n(2254),E=n(2255),F=n(2256),B=n(2257),_=n(2258),L=Object(u.b)({key:"confirmDlgState",default:{open:!1,msg:"",onConfirm:function(){}}});function Q(){var e=Object(u.c)(L),t=Object(f.a)(e,2),n=t[0],r=n.open,o=n.msg,a=n.onConfirm,c=t[1],i=function(){c({open:!1,msg:"",onConfirm:function(){}})};return Object(h.jsxs)(z.a,{open:r,onClose:i,children:[Object(h.jsx)(E.a,{children:"Confirm"}),Object(h.jsx)(F.a,{children:Object(h.jsx)(B.a,{children:o})}),Object(h.jsxs)(_.a,{children:[Object(h.jsx)(d.a,{onClick:function(){a(),i()},color:"secondary",children:"OK"}),Object(h.jsx)(d.a,{onClick:i,color:"primary",autoFocus:!0,children:"Cancel"})]})]})}var U=n(83),R=n(81),N=n(147),G=n(148);function J(e,t){var n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function W(e,t){return e.replace(";base64",";name=".concat(encodeURIComponent(t),";base64"))}function K(e){var t=e.name,n=e.size,r=e.type;return new Promise((function(o,a){var c=new window.FileReader;c.onerror=a,c.onload=function(e){o({dataURL:W(e.target.result,t),name:t,size:n,type:r})},c.readAsDataURL(e)}))}function V(e){var t=e.filesInfo;return 0===t.length?null:Object(h.jsx)("ul",{className:"file-info",children:t.map((function(e,t){var n=e.name,r=e.size,o=e.type;return Object(h.jsxs)("li",{children:[Object(h.jsx)("strong",{children:n})," (",o,", ",r," bytes)",Object(h.jsx)("br",{}),Object(h.jsx)("button",{onClick:function(){return J(e.name,e.dataURL)},children:"Download"})]},t)}))})}function $(e){return e.filter((function(e){return"undefined"!==typeof e})).map((function(e){var t=function(e){var t,n=e.split(","),r=n[0].split(";"),o=r[0].replace("data:",""),a=r.filter((function(e){return"name"===e.split("=")[0]}));t=1!==a.length?"unknown":a[0].split("=")[1];for(var c=atob(n[1]),i=[],s=0;s<c.length;s++)i.push(c.charCodeAt(s));return{blob:new window.Blob([new Uint8Array(i)],{type:o}),name:t}}(e),n=t.blob;return{name:t.name,size:n.size,type:n.type,dataURL:e}}))}var H=function(e){Object(N.a)(n,e);var t=Object(G.a)(n);function n(e){var r;Object(U.a)(this,n),(r=t.call(this,e)).onChange=function(e){var t,n=r.props,o=n.multiple,a=n.onChange;(t=e.target.files,Promise.all([].map.call(t,K))).then((function(e){var t={values:e.map((function(e){return e.dataURL})),filesInfo:e};r.setState(t,(function(){a(o?t.values:t.values[0])}))}))};var o=e.value,a=Array.isArray(o)?o:[o];return r.state={values:a,filesInfo:$(a)},r}return Object(R.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return function(e,t,n){var r=e.props,o=e.state;return!Z(r,t)||!Z(o,n)}(this,e,t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.multiple,r=t.id,o=t.readonly,a=t.disabled,c=t.autofocus,i=t.options,s=this.state.filesInfo;return Object(h.jsxs)("div",{children:[Object(h.jsx)("p",{children:Object(h.jsx)("input",{ref:function(t){return e.inputRef=t},id:r,type:"file",disabled:o||a,onChange:this.onChange,defaultValue:"",autoFocus:c,multiple:n,accept:i.accept})}),Object(h.jsx)(V,{filesInfo:s})]})}}]),n}(r.Component);H.defaultProps={autofocus:!1};var Y=H;function Z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(e===t)return!0;if("function"===typeof e||"function"===typeof t)return!0;if("object"!==typeof e||"object"!==typeof t)return!1;if(null===e||null===t)return!1;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(e instanceof RegExp&&t instanceof RegExp)return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(X(e)||X(t)){if(!X(e)||!X(t))return!1;var o=Array.prototype.slice;return Z(o.call(e),o.call(t),n,r)}if(e.constructor!==t.constructor)return!1;var a=Object.keys(e),c=Object.keys(t);if(0===a.length&&0===c.length)return!0;if(a.length!==c.length)return!1;for(var i,s=n.length;s--;)if(n[s]===e)return r[s]===t;n.push(e),r.push(t),a.sort(),c.sort();for(var u=a.length-1;u>=0;u--)if(a[u]!==c[u])return!1;for(var l=a.length-1;l>=0;l--)if(!Z(e[i=a[l]],t[i],n,r))return!1;return n.pop(),r.pop(),!0}function X(e){return"[object Arguments]"===Object.prototype.toString.call(e)}var ee=n(2056),te=n(2259),ne=Object(u.b)({key:"longRunningTaskState",default:{open:!1,msg:""}});function re(){var e=Object(u.c)(ne),t=Object(f.a)(e,2)[1],n=function(){var e=Object(T.a)(Object(M.a)().mark((function e(n,r){var o;return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({open:!0,msg:n}),e.prev=1,e.next=4,r();case 4:t({open:!1,msg:""}),e.next=13;break;case 7:e.prev=7,e.t0=e.catch(1),o="Error running task: ".concat(n),console.error(o,e.t0),t({open:!0,msg:o}),setTimeout((function(){return t({open:!1,msg:""})}),3e3);case 13:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}();return n}var oe=Object(y.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},msg:{margin:"1em"}}}));function ae(){var e=Object(u.c)(ne),t=Object(f.a)(e,1)[0],n=t.open,r=t.msg,o=oe();return Object(h.jsxs)(ee.a,{className:o.backdrop,open:n,children:[Object(h.jsx)(te.a,{color:"inherit"}),Object(h.jsx)(C.a,{className:o.msg,children:r})]})}var ce=Object(y.a)((function(){return{buttons:{display:"flex",justifyContent:"space-between"}}}));function ie(e){var t=e.bookId,n=e.collection,o=e.doc,a=e.onDelete,c=e.onCancel,i=ce(),s=re(),l=v(),b=function(){var e=Object(u.c)(L),t=Object(f.a)(e,2)[1];return function(e,n){t({open:!0,msg:e,onConfirm:n})}}(),j=Object(A.g)(),m=Object(r.useState)(o),O=Object(f.a)(m,2),y=O[0],g=O[1],x=Object(r.useState)(se(y)),w=Object(f.a)(x,2),I=w[0],C=w[1],P="books"===n?n:[t,n],z=Object(S.l)(P,o.id),E=function(){var e=Object(T.a)(Object(M.a)().mark((function e(){var t;return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a&&a(),"string"!==typeof P){e.next=3;break}return e.abrupt("return");case 3:if("pages"!==(t=P)[1]){e.next=9;break}s("Deleting page...",Object(T.a)(Object(M.a)().mark((function e(){return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.e)(t,o.id);case 2:l("info","Successfully deleted the page");case 3:case"end":return e.stop()}}),e)})))),e.next=19;break;case 9:return e.prev=9,e.next=12,Object(S.e)(t,o.id);case 12:l("info","Successfully deleted"),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(9),console.error("Successfully deleted document of ".concat(n,": ").concat(o.id)),l("error","Could not delete");case 19:case"end":return e.stop()}}),e,null,[[9,15]])})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)(k,{children:Object(h.jsx)(p.a,{autoComplete:"off",schema:q.jsonSchemas[n],uiSchema:D.b[n],widgets:{FileWidget:Y},formData:y,onSubmit:function(e){var t=e.formData;return z(t).then((function(){g(t),C(se(t)),l("info","Successfully updated")}),(function(e){l("error","Could not update"),console.error(e)}))},children:Object(h.jsxs)("div",{className:i.buttons,children:[c&&Object(h.jsx)(d.a,{onClick:c,children:"Cancel"}),Object(h.jsx)(d.a,{type:"submit",color:"primary",children:"Update"}),"books"===n&&Object(h.jsx)(d.a,{color:"primary",onClick:function(){return j.push("/books/".concat(t))},children:"Edit content"}),"books"!==n&&Object(h.jsx)(d.a,{color:"secondary",onClick:function(){q.macroTypes.includes(n)?E():b("Do you want to delete this document of ".concat(n,"?"),E)},children:"Delete"})]})},I)})}function se(e){var t=ue(e);return"".concat(e.id,"-").concat(t.join("-"))}function ue(e){for(var t=[],n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];t.push(o);var a=e[o];"object"!==typeof a||Array.isArray(a)||t.push.apply(t,Object(P.a)(ue(a)))}return t}var le=n(2263),de=n(2264),pe=n(2251),fe=n(2333),be=n(1180),je=n.n(be),he=n(198),me=n(2262);function Oe(){var e=Object(s.c)(),t=Object(s.g)().data,n=v(),r=Object(A.g)();return Object(h.jsx)("div",{children:Object(h.jsxs)(C.a,{children:[Object(h.jsx)(d.a,{color:"primary",onClick:function(){e.signOut().then((function(){return r.push("/")}),(function(e){n("error","Could not logout"),console.error(e)}))},children:"Logout"}),t.email]})})}var ve=n(514),ye=n.n(ve);function ge(){return(ge=Object(T.a)(Object(M.a)().mark((function e(t){var n,r;return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.f)(t);case 2:return n=e.sent,r=ye()(n,{space:2}),e.next=6,ke("backup/"+Ie(t,{timestamped:!0}),r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(){return(xe=Object(T.a)(Object(M.a)().mark((function e(t){var n,r;return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.f)(t);case 2:return n=e.sent,r=ye()(n,{space:2}),e.next=6,ke("backup/"+Ie(t,{timestamped:!0,tag:"publish"}),r);case 6:return e.next=8,ke("publish/"+Ie(t),r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e,t){return we.apply(this,arguments)}function we(){return(we=Object(T.a)(Object(M.a)().mark((function e(t,n){var r;return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=I.c.ref(t),e.next=3,r.putString(n,void 0,{contentType:"text/json"}).then();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.timestamped,r=t.tag,o=n?"-"+Ae():"",a=r?"-"+r:"";return"".concat(e,"/happy-").concat(e).concat(o).concat(a,".json")}function Ae(){return(new Date).toISOString()}function Ce(){var e=Object(A.h)().bookId,t=Object(A.g)(),n=Object(S.j)("books",e),o=v();Object(r.useEffect)((function(){n||(console.error("Book not found: ".concat(e)),t.replace("/"))}));return n?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{children:[Object(h.jsx)(d.a,{color:"primary",onClick:function(){Object(S.f)(e).then((function(t){!function(e,t){var n=ye()(t,{space:2});J(e,"data:application/json;charset=utf-8,"+encodeURIComponent(n))}("happy-".concat(e,".json"),t)}),(function(e){o("error","Could not download"),console.error(e)}))},children:"Download"}),Object(h.jsx)(d.a,{color:"primary",onClick:function(){(function(e){return ge.apply(this,arguments)})(e).then((function(){o("info","Created backup")}),(function(e){o("error","Could not backup"),console.error(e)}))},children:"Backup"}),Object(h.jsx)(d.a,{color:"primary",onClick:function(){(function(e){return xe.apply(this,arguments)})(e).then((function(){o("info","Created backup and published")}),(function(e){o("error","Could not publish"),console.error(e)}))},children:"Publish"})]}),Object(h.jsx)(d.a,{color:"primary",onClick:function(){return t.push("/")},children:"View book list"})]}):Object(h.jsx)(h.Fragment,{})}var Se=n(2260);function Pe(){var e=Object(A.h)().bookId,t=Object(A.g)(),n="#/books/".concat(e,"/question-playground");return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(j.a,{severity:"info",children:Object(h.jsx)(Se.a,{href:n,onClick:function(){return t.push(n)},children:"Question generation playground"})}),Object(h.jsx)(j.a,{severity:"info",children:Object(h.jsx)(Se.a,{href:"https://oblador.github.io/react-native-vector-icons/",target:"_blank",children:"Icons"})}),Object(h.jsx)(j.a,{severity:"info",children:Object(h.jsx)(Se.a,{href:"https://translate.google.com/?hl=vi&sl=en&tl=vi&op=translate",target:"_blank",children:"Google Translate"})})]})}var Me=n(99),Te=n(2261),qe=n(2334),De=n(823),ze=n.n(De),Ee=n(1179),Fe=n.n(Ee),Be=n(1178),_e=n.n(Be);function Le(){return(Le=Object(T.a)(Object(M.a)().mark((function e(t){var n,r,o,a;return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object.keys(q.topPageIds),r=0;case 2:if(!(r<n.length)){e.next=10;break}return o=n[r],a={parentId:t,order:r+1,id:o,title:o},e.next=7,Object(S.b)([t,"pages"],o,a);case 7:r++,e.next=2;break;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qe(e){var t=e.msg;return Object(h.jsx)(C.a,{color:"error",children:t})}var Ue=function(e){Object(N.a)(n,e);var t=Object(G.a)(n);function n(e){var r;return Object(U.a)(this,n),(r=t.call(this,e)).state={hasError:!1},r}return Object(R.a)(n,[{key:"render",value:function(){return this.state.hasError?Object(h.jsx)(Qe,{msg:this.props.errorMsg}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return console.error(e),{hasError:!0}}}]),n}(r.Component);function Re(e){return Object(h.jsx)(Ue,{errorMsg:e.errorMsg,children:Object(h.jsx)(r.Suspense,{fallback:Object(h.jsx)(te.a,{}),children:e.children})})}var Ne=n(69),Ge=Object(u.b)({key:"docTreeState",default:{expandedNodeIds:["pages"],selectedNodeId:"pages"}});function Je(e,t,n){return"/books/".concat(e,"/").concat(t,"/").concat(n)}var We=Je;function Ke(){return Object(u.c)(Ge)}function Ve(){var e=Object(A.h)().bookId,t=Object(S.j)("books",e),n=Ke(),r=Object(f.a)(n,2),o=r[0],a=o.expandedNodeIds,c=o.selectedNodeId,i=r[1];return Object(h.jsxs)(k,{children:[Object(h.jsx)(C.a,{variant:"h5",children:null===t||void 0===t?void 0:t.title}),Object(h.jsx)(C.a,{variant:"h6",children:null===t||void 0===t?void 0:t.subtitle}),Object(h.jsxs)(Te.a,{defaultCollapseIcon:Object(h.jsx)(_e.a,{}),defaultExpandIcon:Object(h.jsx)(Fe.a,{}),expanded:a,selected:c,onNodeToggle:function(e,t){return i({expandedNodeIds:t,selectedNodeId:c})},children:[Object(h.jsx)($e,{bookId:e}),Object(h.jsx)(He,{bookId:e})]})]})}function $e(e){var t=e.bookId;return Object(h.jsx)(qe.a,{nodeId:"lists",label:"Text lists",children:Object(h.jsx)(Ye,{bookId:t,collection:"lists",recursive:!1,level:0,parentId:t,labelMaker:function(e){return e.title}})})}function He(e){var t=e.bookId;return Object(r.useEffect)((function(){Object(S.g)("books",t).then((function(e){e&&function(e){Le.apply(this,arguments)}(t)}))}),[t]),Object(h.jsx)(qe.a,{nodeId:"pages",label:"Pages",children:Object(h.jsx)(Ye,{bookId:t,collection:"pages",recursive:!0,level:0,parentId:t,labelMaker:function(e){return e.title}})})}function Ye(e){return Object(h.jsx)(Re,{errorMsg:"Error loading ".concat(e.collection),children:Object(h.jsx)(Ze,Object(Me.a)({},e))})}function Ze(e){var t=e.bookId,n=e.collection,r=e.recursive,o=e.level,a=e.parentId,c=e.grandParentId,i=e.labelMaker,s=Object(A.g)(),u=Ke(),l=Object(f.a)(u,1)[0].selectedNodeId,d=Object(S.m)([t,n],a),p=v(),b=function(e){Object(S.c)([t,n],e).then((function(e){s.push(Je(t,n,e))}),(function(e){console.error(e),p("error","Could not add new document to ".concat(n))}))};return Object(h.jsxs)(h.Fragment,{children:[d.map((function(e){var c=e.id,u=We(t,n,c),l=Je(t,n,c);return Object(h.jsx)(qe.a,{nodeId:u,label:i(e),onLabelClick:function(e){e.preventDefault(),s.push(l)},children:r&&Object(h.jsx)(Ye,{bookId:t,collection:n,recursive:!0,level:o+1,parentId:c,grandParentId:a,labelMaker:i})},u)})),(a===t&&"pages"!==n||We(t,n,a)===l)&&Object(h.jsxs)(h.Fragment,{children:[o<=3&&Object(h.jsx)(qe.a,{nodeId:"add-doc-to-".concat(t,"-").concat(n,"-").concat(a),icon:Object(h.jsx)(ze.a,{}),label:"Add child",onClick:function(){return b(a)}}),c&&Object(h.jsx)(qe.a,{nodeId:"add-doc-to-".concat(t,"-").concat(n,"-").concat(c),icon:Object(h.jsx)(ze.a,{}),label:"Add sibling",onClick:function(){return b(c)}})]})]})}function Xe(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(A.b,{path:"/books/:bookId",children:Object(h.jsx)(Ve,{})}),Object(h.jsxs)(k,{children:[Object(h.jsxs)(A.b,{path:"/books/:bookId",children:[Object(h.jsx)(Pe,{}),Object(h.jsx)(Ce,{})]}),Object(h.jsx)(Oe,{})]})]})}function et(){var e=Object(he.a)();return Object(me.a)(e.breakpoints.up("md"))}function tt(e){var t=e.title,n=et(),o=Object(r.useState)(!1),a=Object(f.a)(o,2),c=a[0],i=a[1];return Object(h.jsx)(le.a,{position:"static",children:Object(h.jsxs)(de.a,{children:[!n&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(pe.a,{color:"inherit",edge:"start",onClick:function(){return i(!0)},children:Object(h.jsx)(je.a,{})}),Object(h.jsx)(fe.a,{anchor:"left",open:c,onClose:function(){return i(!1)},children:Object(h.jsx)(Xe,{})})]}),Object(h.jsx)(C.a,{children:t})]})})}function nt(e){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(tt,{title:e.title}),Object(h.jsx)("div",{style:{marginTop:"1em"},children:Object(h.jsx)(Re,{errorMsg:"There's error, please try reloading this web page.",children:e.children})})]})}var rt=Object(h.jsx)(A.b,{path:"/",exact:!0,children:Object(h.jsx)(nt,{title:"Books",children:Object(h.jsx)(ot,{})})});function ot(){var e=Object(S.m)("books",void 0);return e.sort((function(e,t){return e.title<t.title?-1:1})),Object(h.jsxs)(h.Fragment,{children:[e.map((function(e){return Object(h.jsx)(ie,{bookId:e.id,collection:"books",doc:e,onDelete:function(){}},e.id)})),Object(h.jsx)(d.a,{color:"primary",onClick:function(){return Object(S.c)("books",void 0)},children:"Add book"}),Object(h.jsx)(j.a,{severity:"info",children:Object(h.jsx)(C.a,{children:"Deleting books from this admin UI is not effecient for the system. If you want to delete a book, please contact a DB admin."})})]})}var at=Object(h.jsx)(A.b,{path:"/books/:bookId",exact:!0,children:Object(h.jsx)(nt,{title:"Edit book",children:Object(h.jsx)(ct,{})})});function ct(){return Object(h.jsx)(C.a,{children:"Please start from the sidebar."})}var it=n(1268),st=n(1265),ut=(n(2043),n(2044),{status:"pending",promise:null,result:null});function lt(e,t){if("fulfilled"===e.status)return e.result;if("rejected"===e.status)throw e.result;throw e.promise||(e.promise=t().then((function(t){"pending"===e.status&&(e.status="fulfilled",e.promise=null,e.result=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.promise=null,e.result=t)}))),e.promise}var dt=function(e){var t={status:"pending",promise:null,result:null};return function(o){var a=lt(ut,(function(){return n.e(183).then(n.bind(null,3200))})).default,c=lt(t,e).default,i=Object(r.useRef)(null),s=Object(r.useRef)(null);return Object(r.useLayoutEffect)((function(){s.current||(s.current=a(i.current));var e=s.current;return function(){e.unmount()}}),[a]),Object(r.useLayoutEffect)((function(){s.current&&s.current.render(c,o)}),[c,o]),Object(h.jsx)("div",{style:{display:"contents"},ref:i})}}((function(){return Promise.resolve().then(n.bind(null,1265))}));function pt(e){var t=e.bookId,n=e.pageId,r=Object(S.n)(t,n),o=v();return Object(h.jsx)(Re,{errorMsg:"Could not render macros",children:Object(h.jsx)(dt,{pageId:n,before:r,onSave:function(e){var n=e.after,a=e.create,c=e.update,i=e.remove,s=Promise.all(a.map((function(e){var r=n[e],o=[t,r.macroType];return Object(S.a)(o,r.doc).then((function(e){return r.doc.id=e}))}))),u=Promise.all(c.map((function(e){var r=n[e],o=[t,r.macroType];return Object(S.h)(o,r.doc.id,r.doc)}))),l=Promise.all(i.map((function(e){var n=r[e],o=[t,n.macroType];return Object(S.e)(o,n.doc.id)})));return Promise.all([s,u,l]).then((function(){return o("info","Successfully updated"),n}),(function(e){return o("error","Could not update"),console.error(e),n}))}},"".concat(t,"-").concat(n))})}var ft=Object(u.b)({key:"srcPageState",default:{srcBookId:"",srcPage:void 0}});function bt(e){var t=e.bookId,n=e.currentPageAndAncestors,r=Object(u.c)(ft),o=Object(f.a)(r,2),a=o[0],c=a.srcBookId,i=a.srcPage,s=o[1],l=re(),p=v(),b=n[0],j=Object.keys(q.topPageIds).includes(b.id),m=Object(h.jsx)(d.a,{color:"secondary",onClick:function(){s({srcBookId:t,srcPage:b}),p("info","Select a page at the page tree to copy/move to")},children:"Copy/move this page"});if(!i)return j?null:m;if(i&&i.id===b.id)return null;if(function(e,t,n,r){if(e!==n)return!1;var o,a=Object(Ne.a)(r);try{for(a.s();!(o=a.n()).done;){if(o.value.id===t.id)return!0}}catch(c){a.e(c)}finally{a.f()}return!1}(c,i,t,n))return m;if(function(e,t,n,r){if(e!==n)return!1;return t.parentId===r.id}(c,i,t,b))return m;var O=Object(h.jsx)(d.a,{color:"secondary",onClick:Object(T.a)(Object(M.a)().mark((function e(){return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s({srcBookId:"",srcPage:void 0}),l("Copying page...",Object(T.a)(Object(M.a)().mark((function e(){return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.d)({bookIdAndDataCollection:[c,"pages"],id:i.id},{bookIdAndDataCollection:[t,"pages"],parentId:b.id});case 2:p("info","Page copy finished");case 3:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)}))),children:"Copy it here"}),y=Object(h.jsx)(d.a,{color:"secondary",onClick:Object(T.a)(Object(M.a)().mark((function e(){return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({srcBookId:"",srcPage:void 0}),e.next=3,Object(S.i)([t,"pages"],i.id,b.id);case 3:p("info","Page move finished");case 4:case"end":return e.stop()}}),e)}))),children:"Move it here"}),g=Object(h.jsx)(Se.a,{href:"/#/books/".concat(t,"/pages/").concat(i.id),target:"_blank",children:"Page to move"});return Object(h.jsxs)(h.Fragment,{children:[g,O,c===t&&y,m]})}var jt=[["lists","Edit text list"],["pages","Edit page"]].map((function(e){var t=Object(f.a)(e,2),n=t[0],r=t[1];return Object(h.jsx)(A.b,{path:"/books/:bookId/".concat(n,"/:bookDataId"),exact:!0,children:Object(h.jsx)(nt,{title:r,children:Object(h.jsx)(ht,{collection:n})})},n)}));function ht(e){var t=e.collection,n=Object(A.h)(),o=n.bookId,a=n.bookDataId,c=Object(S.k)([o,t],a),i=function(){var e=Object(u.c)(Ge),t=Object(f.a)(e,2),n=t[0].expandedNodeIds,o=t[1];return Object(r.useCallback)((function(e,t,r,a){var c,i=We(e,t,r),s=Object(P.a)(n),u=Object(Ne.a)(a);try{for(u.s();!(c=u.n()).done;){var l=c.value,d=We(e,t,l);s.includes(d)||s.push(d)}}catch(f){u.e(f)}finally{u.f()}var p=s.length!==n.length;o({expandedNodeIds:p?s:n,selectedNodeId:i})}),[n,o])}(),s=Object(A.g)(),l=Object(r.useState)(!1),p=Object(f.a)(l,2),b=p[0],j=p[1],m=c.map((function(e){return e.id}));if(Object(it.a)((function(){return i(o,t,a,m)}),[i,o,t,a,m]),0===c.length)return Object(h.jsx)(Qe,{msg:"Could not load data to edit"});var O=q.shortJsonSchemas[t],v=Object.keys(O.properties),y=c[0],x="".concat(o,"/").concat(t,"/").concat(a);return Object(h.jsxs)(h.Fragment,{children:["pages"===t&&Object(h.jsx)(bt,{bookId:o,currentPageAndAncestors:c}),b?Object(h.jsx)(ie,{bookId:o,collection:t,doc:y,onDelete:function(){return s.push("/books/".concat(o))},onCancel:function(){return j(!1)}},x):Object(h.jsxs)(g.a,{style:{padding:"1em",marginBottom:"1em"},children:[Object(h.jsx)(st.DocShow,{doc:y,sortKeys:v}),Object(h.jsx)(d.a,{color:"primary",onClick:function(){return j(!0)},children:"Edit"})]}),"pages"===t&&Object(h.jsx)(Re,{errorMsg:"Could not load macros",children:Object(h.jsx)(pt,{bookId:o,pageId:a},x)})]})}var mt=n(2320),Ot=n(1263),vt=n.n(Ot),yt=Object(h.jsx)(A.b,{path:"/books/:bookId/question-playground",children:Object(h.jsx)(nt,{title:"Question generation playground",children:Object(h.jsx)(gt,{})})});function gt(){var e=Object(r.useState)(""),t=Object(f.a)(e,2),n=t[0],o=t[1],a=Object(r.useState)([]),c=Object(f.a)(a,2),i=c[0],s=c[1],u=Object(r.useState)([]),l=Object(f.a)(u,2),p=l[0],b=l[1],j=Object(r.useState)([]),m=Object(f.a)(j,2),O=m[0],v=m[1],y=Object(r.useState)(!1),g=Object(f.a)(y,2),x=g[0],k=g[1],w=Object(r.useState)(""),I=Object(f.a)(w,2),A=I[0],S=I[1];return Object(h.jsxs)(h.Fragment,{children:[!x&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(mt.a,{fullWidth:!0,multiline:!0,rows:10,value:n,onChange:function(e){return o(e.target.value)}}),Object(h.jsx)(d.a,{color:"primary",disabled:0===n.trim().length,onClick:Object(T.a)(Object(M.a)().mark((function e(){var t,r,o,a,c,i,u,l,d,p,f,j;return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(!0),S(""),s([]),b([]),v([]),t=vt.a.sentences(n,{newline_boundaries:!0}),s(t),r=[],o=[],e.prev=9,a=Object(Ne.a)(t),e.prev=11,a.s();case 13:if((c=a.n()).done){e.next=42;break}return i=c.value,e.next=17,wt(i);case 17:u=e.sent,r.push(u),l=[],d=Object(Ne.a)(u),e.prev=21,d.s();case 23:if((p=d.n()).done){e.next=31;break}return f=p.value,e.next=27,At(f,i);case 27:j=e.sent,l.push(j);case 29:e.next=23;break;case 31:e.next=36;break;case 33:e.prev=33,e.t0=e.catch(21),d.e(e.t0);case 36:return e.prev=36,d.f(),e.finish(36);case 39:o.push(l);case 40:e.next=13;break;case 42:e.next=47;break;case 44:e.prev=44,e.t1=e.catch(11),a.e(e.t1);case 47:return e.prev=47,a.f(),e.finish(47);case 50:b(r),v(o),e.next=57;break;case 54:e.prev=54,e.t2=e.catch(9),S(e.t2.message);case 57:k(!1);case 58:case"end":return e.stop()}}),e,null,[[9,54],[11,44,47,50],[21,33,36,39]])}))),children:"Generate questions"})]}),x&&Object(h.jsx)(te.a,{}),A.length>0&&Object(h.jsx)(Qe,{msg:A}),i.map((function(e,t){return Object(h.jsxs)("div",{children:[Object(h.jsxs)(C.a,{children:[t+1,". ",e]}),p[t]&&O[t]&&Object(h.jsx)("div",{children:p[t].map((function(e,n){return Object(h.jsxs)("div",{children:[Object(h.jsxs)(C.a,{children:["Q: ",e]}),Object(h.jsxs)(C.a,{children:["A: ",O[t][n]]})]},n)}))},t),Object(h.jsx)("hr",{})]},t)}))]})}var xt="https://api-inference.huggingface.co",kt="api_DwXNmIqfMrkqtAsBPajwkjVDLzUNGeFzBr";function wt(e){return It.apply(this,arguments)}function It(){return(It=Object(T.a)(Object(M.a)().mark((function e(t){var n,r,o,a;return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(xt,"/models/valhalla/t5-base-e2e-qg"),{headers:{authorization:"Bearer ".concat(kt)},body:JSON.stringify({inputs:"generate questions: ".concat(t," </s>")}),method:"POST"});case 2:if((n=e.sent).ok){e.next=8;break}return e.next=6,n.text();case 6:throw r=e.sent,new Error(r);case 8:return e.next=10,n.json();case 10:return o=e.sent,a=o[0].generated_text,e.abrupt("return",a.split("<sep>").map((function(e){return e.trim()})).filter((function(e){return e.length>0})));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function At(e,t){return Ct.apply(this,arguments)}function Ct(){return(Ct=Object(T.a)(Object(M.a)().mark((function e(t,n){var r,o,a,c;return Object(M.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(xt,"/models/valhalla/t5-base-qa-qg-hl"),{headers:{authorization:"Bearer ".concat(kt)},body:JSON.stringify({inputs:"question: ".concat(t,"  context: ").concat(n," </s>")}),method:"POST"});case 2:if((r=e.sent).ok){e.next=8;break}return e.next=6,r.text();case 6:throw o=e.sent,new Error(o);case 8:return e.next=10,r.json();case 10:return a=e.sent,c=a[0].generated_text,e.abrupt("return",c);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function St(){var e=et();return Object(h.jsxs)(l.a,{container:!0,spacing:e?2:0,children:[e&&Object(h.jsx)(l.a,{item:!0,md:5,children:Object(h.jsx)(Xe,{})}),Object(h.jsx)(l.a,{item:!0,md:7,sm:12,children:Object(h.jsxs)(A.d,{children:[rt,at,jt,yt,Object(h.jsx)(A.a,{from:"*",to:"/"})]})})]})}function Pt(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(i.a,{}),Object(h.jsx)(Re,{errorMsg:"There's error, please try reloading this page",children:Object(h.jsx)(u.a,{children:Object(h.jsxs)(c.a,{children:[Object(h.jsx)(O,{}),Object(h.jsx)(Q,{}),Object(h.jsx)(ae,{}),Object(h.jsx)(s.b,{firebaseApp:I.a,suspense:!0,children:Object(h.jsx)(s.a,{fallback:Object(h.jsx)(w,{}),children:Object(h.jsx)(St,{})})})]})})})]})}a.a.render(Object(h.jsx)(Pt,{}),document.getElementById("root"))},329:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c}));var r=n(280),o=(n(2050),n(2051),r.a.initializeApp({apiKey:"AIzaSyB-svyOf1GKrlLnGCNWFo7SA9xMzKKLkys",projectId:"happy-child-302620",authDomain:"localhost",storageBucket:"gs://happy-child-302620.appspot.com"})),a=r.a.firestore(o),c=r.a.storage(o);e.firestore=a}).call(this,n(186))},332:function(e,t,n){"use strict";var r=n(743).default;Object.defineProperty(t,"__esModule",{value:!0}),t.isOrdered=t.collectionFromPath=t.collectionPath=void 0;var o=n(104);function a(e){return"string"===typeof e?e:e[1]}t.collectionPath=function(e){if("string"===typeof e)return e;var t=r(e,2),n=t[0],o=t[1];return"books/".concat(n,"/").concat(o)},t.collectionFromPath=a,t.isOrdered=function(e){var t=a(e),n=o.collectionsWithoutParent,r=o.childCollectionsWithoutOrder;return!n.includes(t)&&!r.includes(t)}},624:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return g}));var r,o=n(55),a=n(69),c=n(104),i=Object(a.a)(c.collections);try{for(i.s();!(r=i.n()).done;){var s=r.value;delete c.jsonSchemas[s].properties.id,delete c.jsonSchemas[s].properties.parentId}}catch(x){i.e(x)}finally{i.f()}var u,l={},d=Object(a.a)(c.collections);try{for(d.s();!(u=d.n()).done;){var p=u.value;l[p]={}}}catch(x){d.e(x)}finally{d.f()}var f,b={"ui:widget":"textarea","ui:options":{rows:20}},j=Object(c.getMarkdownProperties)(),h=Object(a.a)(c.collections);try{for(h.s();!(f=h.n()).done;){var m,O=f.value,v=Object(a.a)(j[O]);try{for(v.s();!(m=v.n()).done;){var y=m.value;l[O][y]=b}}catch(x){v.e(x)}finally{v.f()}}}catch(x){h.e(x)}finally{h.f()}var g={};c.collections.forEach((function(e){var t=c.jsonSchemas[e].properties;g[e]={};for(var n=0,r=Object.entries(t);n<r.length;n++){var a=Object(o.a)(r[n],2),i=a[0],s=a[1];g[e][i]=s.default}}))},740:function(e,t,n){"use strict";var r=n(976).default;Object.defineProperty(t,"__esModule",{value:!0}),t.collections=t.bookDataCollections=t.childCollectionsWithoutOrder=t.collectionsWithoutParent=void 0;var o=n(742);t.collectionsWithoutParent=["books"],t.childCollectionsWithoutOrder=["lists"],t.bookDataCollections=[].concat(r(t.childCollectionsWithoutOrder),["pages"],r(o.macroTypes)),t.collections=[].concat(r(t.collectionsWithoutParent),r(t.bookDataCollections))},742:function(e,t,n){"use strict";var r=n(1608).default,o=n(976).default,a=n(978).default,c=n(1609).default;function i(){return(i=c(r().mark((function e(n,c){var i,u,l,d,p,f;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],u=a(t.macroTypes),e.prev=2,u.s();case 4:if((l=u.n()).done){e.next=13;break}return d=l.value,e.next=8,c(d,n);case 8:p=e.sent,f=s(d,p),i.push.apply(i,o(f));case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),u.e(e.t0);case 18:return e.prev=18,u.f(),e.finish(18);case 21:return i.sort((function(e,t){return e.doc.order-t.doc.order})),e.abrupt("return",i);case 23:case"end":return e.stop()}}),e,null,[[2,15,18,21]])})))).apply(this,arguments)}function s(e,t){return t.map((function(t){return{macroType:e,doc:t}}))}Object.defineProperty(t,"__esModule",{value:!0}),t.useMacros=t.getMacros=t.tocTypes=t.panelTypes=t.includePageTypes=t.macroTypes=void 0,t.macroTypes=["mQuizzes","mRearrangeQuizzes","mInputQuizzes","mQuizGroups","mQuizTests","mAccordions","mAudios","mExpands","mImages","mIncludePages","mInputs","mListSelects","mListShows","mMarkdowns","mPanels","mQuotes","mSurveys","mTocs","mYouTubes"],t.includePageTypes=["inline","expand","link"],t.panelTypes=["info","note","success","warning","error"],t.tocTypes=["parts","chapters","pages"],t.getMacros=function(e,t){return i.apply(this,arguments)},t.useMacros=function(e,n){var r,c=[],i=a(t.macroTypes);try{for(i.s();!(r=i.n()).done;){var u=r.value,l=s(u,n(u,e));c.push.apply(c,o(l))}}catch(d){i.e(d)}finally{i.f()}return c.sort((function(e,t){return e.doc.order-t.doc.order})),c}},821:function(e,t,n){"use strict";function r(e,t){return e?new Promise((function(n){var r=new Image;r.onload=function(){if(r.width<=t)n(e);else{var o=function(e,t){var n=e.height*t/e.width,r=document.createElement("canvas");return r.width=t,r.height=n,r.getContext("2d").drawImage(e,0,0,t,n),r.toDataURL("image/jpeg",.7)}(r,t);n(o)}},r.src=e})):Promise.resolve("")}n.d(t,"a",(function(){return r}))},979:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iconSets=void 0,t.iconSets=["AntDesign","Entypo","EvilIcons","Feather","FontAwesome","FontAwesome5","Fontisto","Foundation","Ionicons","MaterialCommunityIcons","MaterialIcons","Octicons","Zocial","SimpleLineIcons"]},980:function(e,t,n){"use strict";var r=n(743).default;Object.defineProperty(t,"__esModule",{value:!0}),t.getMarkdownProperties=t.jsonSchemas=t.shortJsonSchemas=t.defaultImage=void 0;var o=n(740),a=n(979),c=n(742);t.defaultImage="data:image/gif;base64,R0lGODlhEAAQAMQAAORHHOVSKudfOulrSOp3WOyDZu6QdvCchPGolfO0o/XBs/fNwfjZ0frl3/zy7////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAkAABAALAAAAAAQABAAAAVVICSOZGlCQAosJ6mu7fiyZeKqNKToQGDsM8hBADgUXoGAiqhSvp5QAnQKGIgUhwFUYLCVDFCrKUE1lBavAViFIDlTImbKC5Gm2hB0SlBCBMQiB0UjIQA7";var i={title:"Quiz",description:"Macro that shows a quiz (can be multiple choices)",type:"object",properties:{question:{type:"string",default:"Quiz question?",$comment:"Markdown"},image:{type:"string",format:"data-url"},choices:{type:"array",items:{title:"Choice",type:"object",properties:{choice:{type:"string",default:"Choice"},correct:{type:"boolean",default:!1}},required:["choice","correct"]},uniqueItems:!0,default:[{choice:"Choice 1",correct:!0},{choice:"Choice 2",correct:!1}]},multiple:{type:"boolean",default:!1},explanation:{description:"Explanation about the answer",type:"string",default:"Markdown text",$comment:"Markdown"}},required:["question","choices","multiple"]};t.shortJsonSchemas={books:{title:"Book",type:"object",properties:{title:{type:"string",default:"Book title"},subtitle:{type:"string",default:"Subtitle"},language:{type:"string",enum:["en","vi"],default:"en"},shareUrl:{type:"string",default:"https://toxgam.github.io/"},supportUrl:{type:"string",default:"https://facebook.com/"}},required:["title","language","shareUrl","supportUrl"]},lists:{title:"List",description:"List of groups of text",type:"object",properties:{title:{type:"string",default:"List title"},groups:{type:"array",items:{title:"Group",type:"object",properties:{name:{type:"string",default:"Group name"},items:{type:"array",items:{type:"string",default:"Item name"},uniqueItems:!0}},required:["name","items"]},uniqueItems:!0,default:[{name:"Group 1",items:["Item1","Item2"]},{name:"Group 2",items:["Item3","Item4"]}]}},required:["title","groups"]},pages:{title:"Page",description:"Pages can be structured into a tree",type:"object",properties:{title:{type:"string",default:"Page title"},visual:{oneOf:[{title:"Icon",type:"object",properties:{iconSet:{type:"string",enum:a.iconSets,default:"Ionicons"},icon:{type:"string",default:"paper-plane-outline"}},required:["iconSet","icon"]},{title:"Image",type:"string",format:"data-url",default:t.defaultImage}],default:{iconSet:"Ionicons",icon:"paper-plane-outline"}}},required:["title"]},mQuizzes:i,mRearrangeQuizzes:{title:"Rearrange quiz",description:"Macro that asks user to rearrange a list of items",type:"object",properties:{question:{type:"string",default:"Quiz question?",$comment:"Markdown"},items:{type:"array",items:{title:"Item",type:"string"},default:[]}},required:["question","items"]},mInputQuizzes:{title:"Input quiz",description:"Macro that asks user to input",type:"object",properties:{question:{type:"string",default:"Quiz question?",$comment:"Markdown"},validInputs:{type:"array",items:{title:"Valid input",type:"string"},default:[]}},required:["question","validInputs"]},mQuizGroups:{title:"Quiz group",description:"Macro that shows a group of quizzes",type:"object",properties:{question:{type:"string",default:"Question for the group of quizzes?",$comment:"Markdown"},quizzes:{type:"array",items:i,default:[]}},required:["question","quizzes"]},mQuizTests:{title:"Quiz test",description:"Macro that shows a test containing multiple quizzes",type:"object",properties:{title:{type:"string",default:"Title"},instruction:{type:"string",default:"Instruction for the test.",$comment:"Markdown"},min:{description:"Minimum number of quizzes to create",type:"integer",default:5},max:{description:"Maximum number of quizzes to create",type:"integer",default:50},sources:{type:"array",items:{title:"Quiz source",type:"object",properties:{pageId:{description:"Page containing quizzes",type:"string",default:"pageId"},min:{description:"Minimum number of quizzes to take from this source, when there are multiple sources",type:"integer",default:5},max:{description:"Maximum number of quizzes to take from this source, when there are multiple sources",type:"integer",default:50}},required:["pageId","min","max"]},uniqueItems:!0,default:[{pageId:"pageId",min:5,max:50}]}},required:["title","min","max","sources"]},mAccordions:{title:"Accordion",description:"Macro that shows child pages in an accordion",type:"object",properties:{}},mAudios:{title:"Audio",description:"Macro that shows an audio player",type:"object",properties:{title:{type:"string",default:"Title"},artist:{type:"string",default:"Artist"},url:{type:"string",default:"URL or resource ID"},start:{description:"Start time [ms]",type:"integer",default:0},end:{description:"End time [ms]",type:"integer",default:-1}},required:["title","url","start","end"]},mExpands:{title:"Expand",description:"Macro that shows a single content in the accordion style",type:"object",properties:{title:{type:"string",default:"Title"},body:{type:"string",default:"Body",$comment:"Markdown"}},required:["title","body"]},mImages:{title:"Image",description:"Macro that shows an image",type:"object",properties:{image:{type:"string",format:"data-url",default:t.defaultImage},caption:{type:"string",default:"Image caption"}},required:["image"]},mIncludePages:{title:"Include page",description:"Macro that includes the content of another page",type:"object",properties:{pageId:{type:"string",default:"ID of the page to include"},type:{type:"string",enum:c.includePageTypes,default:"expand"}},required:["pageId","type"]},mInputs:{title:"Input",description:"Macro that records user text input",type:"object",properties:{multiline:{type:"boolean",default:!1}},required:["multiline"]},mListSelects:{title:"List select",description:"Macro that lets user select from a text list",type:"object",properties:{listId:{title:"List ID",type:"string",default:"ID of list to select"}},required:["listId"]},mListShows:{title:"List show",description:"Macro that shows a text list",type:"object",properties:{listId:{title:"List ID",type:"string",default:"ID of list to show"}},required:["listId"]},mMarkdowns:{title:"Markdown",description:"Macro that shows text in Markdown format",type:"object",properties:{text:{type:"string",default:"Markdown text",$comment:"Markdown"}},required:["text"]},mPanels:{title:"Panel",description:"Macro that shows a panel to highlight a content",type:"object",properties:{type:{type:"string",enum:c.panelTypes,default:"info"},body:{type:"string",default:"Markdown text",$comment:"Markdown"}},required:["type","body"]},mQuotes:{title:"Quote",description:"Macro that shows a quote",type:"object",properties:{quote:{type:"string",default:"Quote text",$comment:"Markdown"},author:{type:"string",default:"Author of the quote"},image:{type:"string",format:"data-url",default:t.defaultImage}},required:["quote","author"]},mSurveys:{title:"Survey",description:"Macro that shows a survey question",type:"object",properties:{question:{type:"string",default:"Survey question?",$comment:"Markdown"},choices:{type:"array",items:{type:"string",default:"Choice"},uniqueItems:!0,default:["Choice 1","Choice 2"]},multiple:{type:"boolean",default:!1}},required:["question","choices","multiple"]},mTocs:{title:"Toc",description:"Macro that shows table of contents of child pages",type:"object",properties:{type:{type:"string",enum:c.tocTypes,default:"pages"}},required:["type"]},mYouTubes:{title:"YouTube",description:"Macro that shows a YouTube video",type:"object",properties:{videoId:{type:"string",default:"pVBev5-2Ujk"}},required:["videoId"]}},t.jsonSchemas=JSON.parse(JSON.stringify(t.shortJsonSchemas));for(var s=0,u=Object.entries(t.jsonSchemas);s<u.length;s++){var l=r(u[s],2),d=l[0],p=l[1],f=o.collectionsWithoutParent.includes(d),b=o.childCollectionsWithoutOrder.includes(d);p.properties=Object.assign({id:{type:"string"}},f?{}:b?{parentId:{type:"string"}}:{parentId:{type:"string"},order:{type:"integer",default:99}},p.properties),p.required||(p.required=[]),f?p.required.unshift("id"):b?p.required.unshift("id","parentId"):p.required.unshift("id","parentId","order")}t.getMarkdownProperties=function(){for(var e={},n=0,o=Object.entries(t.jsonSchemas);n<o.length;n++){var a=r(o[n],2),c=a[0],i=a[1];e[c]=[];for(var s=0,u=Object.entries(i.properties);s<u.length;s++){var l=r(u[s],2),d=l[0],p=l[1];"string"===p.type&&"Markdown"===p.$comment&&e[c].push(d)}}return e}}},[[2048,158,159]]]);